(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{539:function(t,n,e){"use strict";e.r(n);var s=e(19),a=Object(s.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"quick-start"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#quick-start"}},[t._v("#")]),t._v(" Quick Start")]),t._v(" "),n("p",[t._v("This article uses a local environment as an example to\nillustrate how to start, expand, and shrink an IoTDB Cluster.")]),t._v(" "),n("p",[n("strong",[t._v("Notice: This document is a tutorial for deploying in a pseudo-cluster environment using different local ports, and is for exercise only. In real deployment scenarios, you only need to configure the IPV4 address or domain name of the server, and do not need to change the Node ports.")])]),t._v(" "),n("h3",{attrs:{id:"_1-prepare-the-start-environment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-prepare-the-start-environment"}},[t._v("#")]),t._v(" 1. Prepare the Start Environment")]),t._v(" "),n("p",[t._v("Unzip the apache-iotdb-1.0.0-all-bin.zip file to cluster0 folder.")]),t._v(" "),n("h3",{attrs:{id:"_2-start-a-minimum-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-start-a-minimum-cluster"}},[t._v("#")]),t._v(" 2. Start a Minimum Cluster")]),t._v(" "),n("p",[t._v("Start the Cluster version with one ConfigNode and one DataNode(1C1D), and\nthe default number of replicas is one.")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("./cluster0/sbin/start-confignode.sh\n./cluster0/sbin/start-datanode.sh\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("h3",{attrs:{id:"_3-verify-the-minimum-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-verify-the-minimum-cluster"}},[t._v("#")]),t._v(" 3. Verify the Minimum Cluster")]),t._v(" "),n("ul",[n("li",[t._v("If everything goes well, the minimum cluster will start successfully. Then, we can start the Cli for verification.")])]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("./cluster0/sbin/start-cli.sh\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("ul",[n("li",[t._v("Execute the "),n("a",{attrs:{href:"https://iotdb.apache.org/UserGuide/Master/Maintenance-Tools/Maintenance-Command.html#show-all-node-information",target:"_blank",rel:"noopener noreferrer"}},[t._v("show cluster details"),n("OutboundLink")],1),t._v("\ncommand on the Cli. The result is shown below:")])]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("IoTDB> show cluster details\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\n|NodeID|  NodeType| Status|InternalAddress|InternalPort|ConfigConsensusPort|RpcAddress|RpcPort|DataConsensusPort|SchemaConsensusPort|MppPort|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\n|     0|ConfigNode|Running|      127.0.0.1|       22277|              22278|          |       |                 |                   |       |\n|     1|  DataNode|Running|      127.0.0.1|        9003|                   | 127.0.0.1|   6667|            40010|              50010|   8777|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\nTotal line number = 2\nIt costs 0.242s\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("h3",{attrs:{id:"_4-prepare-the-expanding-environment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-prepare-the-expanding-environment"}},[t._v("#")]),t._v(" 4. Prepare the Expanding Environment")]),t._v(" "),n("p",[t._v("Unzip the apache-iotdb-1.0.0-all-bin.zip file to cluster1 and cluster2 folder.")]),t._v(" "),n("h3",{attrs:{id:"_5-modify-the-node-configuration-file"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-modify-the-node-configuration-file"}},[t._v("#")]),t._v(" 5. Modify the Node Configuration file")]),t._v(" "),n("p",[t._v("For folder cluster1:")]),t._v(" "),n("ul",[n("li",[t._v("Modify ConfigNode configurations:")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[t._v("configuration item")])]),t._v(" "),n("th",[n("strong",[t._v("value")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("cn_internal_address")]),t._v(" "),n("td",[t._v("127.0.0.1")])]),t._v(" "),n("tr",[n("td",[t._v("cn_internal_port")]),t._v(" "),n("td",[t._v("22279")])]),t._v(" "),n("tr",[n("td",[t._v("cn_consensus_port")]),t._v(" "),n("td",[t._v("22280")])]),t._v(" "),n("tr",[n("td",[t._v("cn_target_config_node_list")]),t._v(" "),n("td",[t._v("127.0.0.1:22277")])])])]),t._v(" "),n("ul",[n("li",[t._v("Modify DataNode configurations:")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[t._v("configuration item")])]),t._v(" "),n("th",[n("strong",[t._v("value")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dn_rpc_address")]),t._v(" "),n("td",[t._v("127.0.0.1")])]),t._v(" "),n("tr",[n("td",[t._v("dn_rpc_port")]),t._v(" "),n("td",[t._v("6668")])]),t._v(" "),n("tr",[n("td",[t._v("dn_internal_address")]),t._v(" "),n("td",[t._v("127.0.0.1")])]),t._v(" "),n("tr",[n("td",[t._v("dn_internal_port")]),t._v(" "),n("td",[t._v("9004")])]),t._v(" "),n("tr",[n("td",[t._v("dn_mpp_data_exchange_port")]),t._v(" "),n("td",[t._v("8778")])]),t._v(" "),n("tr",[n("td",[t._v("dn_data_region_consensus_port")]),t._v(" "),n("td",[t._v("40011")])]),t._v(" "),n("tr",[n("td",[t._v("dn_schema_region_consensus_port")]),t._v(" "),n("td",[t._v("50011")])]),t._v(" "),n("tr",[n("td",[t._v("dn_target_config_node_list")]),t._v(" "),n("td",[t._v("127.0.0.1:22277")])])])]),t._v(" "),n("p",[t._v("For folder cluster2:")]),t._v(" "),n("ul",[n("li",[t._v("Modify ConfigNode configurations:")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[t._v("configuration item")])]),t._v(" "),n("th",[n("strong",[t._v("value")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("cn_internal_address")]),t._v(" "),n("td",[t._v("127.0.0.1")])]),t._v(" "),n("tr",[n("td",[t._v("cn_internal_port")]),t._v(" "),n("td",[t._v("22281")])]),t._v(" "),n("tr",[n("td",[t._v("cn_consensus_port")]),t._v(" "),n("td",[t._v("22282")])]),t._v(" "),n("tr",[n("td",[t._v("cn_target_config_node_list")]),t._v(" "),n("td",[t._v("127.0.0.1:22277")])])])]),t._v(" "),n("ul",[n("li",[t._v("Modify DataNode configurations:")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[t._v("configuration item")])]),t._v(" "),n("th",[n("strong",[t._v("value")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dn_rpc_address")]),t._v(" "),n("td",[t._v("127.0.0.1")])]),t._v(" "),n("tr",[n("td",[t._v("dn_rpc_port")]),t._v(" "),n("td",[t._v("6669")])]),t._v(" "),n("tr",[n("td",[t._v("dn_internal_address")]),t._v(" "),n("td",[t._v("127.0.0.1")])]),t._v(" "),n("tr",[n("td",[t._v("dn_internal_port")]),t._v(" "),n("td",[t._v("9005")])]),t._v(" "),n("tr",[n("td",[t._v("dn_mpp_data_exchange_port")]),t._v(" "),n("td",[t._v("8779")])]),t._v(" "),n("tr",[n("td",[t._v("dn_data_region_consensus_port")]),t._v(" "),n("td",[t._v("40012")])]),t._v(" "),n("tr",[n("td",[t._v("dn_schema_region_consensus_port")]),t._v(" "),n("td",[t._v("50012")])]),t._v(" "),n("tr",[n("td",[t._v("dn_target_config_node_list")]),t._v(" "),n("td",[t._v("127.0.0.1:22277")])])])]),t._v(" "),n("h3",{attrs:{id:"_6-expanding-the-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-expanding-the-cluster"}},[t._v("#")]),t._v(" 6. Expanding the Cluster")]),t._v(" "),n("p",[t._v("Expanding the Cluster to three ConfigNode and three DataNode(3C3D).\nThe following commands can be executed in arbitrary order.")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("./cluster1/sbin/start-confignode.sh\n./cluster1/sbin/start-datanode.sh\n./cluster2/sbin/start-confignode.sh\n./cluster2/sbin/start-datanode.sh\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("h3",{attrs:{id:"_7-verify-cluster-expansion"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-verify-cluster-expansion"}},[t._v("#")]),t._v(" 7. Verify Cluster expansion")]),t._v(" "),n("p",[t._v("Execute the "),n("code",[t._v("show cluster details")]),t._v(" command, then the result is shown below:")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("IoTDB> show cluster details\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\n|NodeID|  NodeType| Status|InternalAddress|InternalPort|ConfigConsensusPort|RpcAddress|RpcPort|DataConsensusPort|SchemaConsensusPort|MppPort|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\n|     0|ConfigNode|Running|      127.0.0.1|       22277|              22278|          |       |                 |                   |       |\n|     2|ConfigNode|Running|      127.0.0.1|       22279|              22280|          |       |                 |                   |       |\n|     3|ConfigNode|Running|      127.0.0.1|       22281|              22282|          |       |                 |                   |       |\n|     1|  DataNode|Running|      127.0.0.1|        9003|                   | 127.0.0.1|   6667|            40010|              50010|   8777|\n|     4|  DataNode|Running|      127.0.0.1|        9004|                   | 127.0.0.1|   6668|            40011|              50011|   8778|\n|     5|  DataNode|Running|      127.0.0.1|        9005|                   | 127.0.0.1|   6669|            40012|              50012|   8779|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\nTotal line number = 6\nIt costs 0.012s\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("h3",{attrs:{id:"_8-shrinking-the-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-shrinking-the-cluster"}},[t._v("#")]),t._v(" 8. Shrinking the Cluster")]),t._v(" "),n("ul",[n("li",[t._v("Remove a ConfigNode:")])]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("# Removing by ip:port\n./cluster0/sbin/remove-confignode.sh 127.0.0.1:22279\n\n# Removing by Node index\n./cluster0/sbin/remove-confignode.sh 2\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("ul",[n("li",[t._v("Remove a DataNode:")])]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("# Removing by ip:port\n./cluster0/sbin/remove-datanode.sh 127.0.0.1:6668\n\n# Removing by Node index\n./cluster0/sbin/remove-confignode.sh 4\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("h3",{attrs:{id:"_9-verify-cluster-shrinkage"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-verify-cluster-shrinkage"}},[t._v("#")]),t._v(" 9. Verify Cluster shrinkage")]),t._v(" "),n("p",[t._v("Execute the "),n("code",[t._v("show cluster details")]),t._v(" command, then the result is shown below:")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("IoTDB> show cluster details\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\n|NodeID|  NodeType| Status|InternalAddress|InternalPort|ConfigConsensusPort|RpcAddress|RpcPort|DataConsensusPort|SchemaConsensusPort|MppPort|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\n|     0|ConfigNode|Running|      127.0.0.1|       22277|              22278|          |       |                 |                   |       |\n|     3|ConfigNode|Running|      127.0.0.1|       22281|              22282|          |       |                 |                   |       |\n|     1|  DataNode|Running|      127.0.0.1|        9003|                   | 127.0.0.1|   6667|            40010|              50010|   8777|\n|     5|  DataNode|Running|      127.0.0.1|        9005|                   | 127.0.0.1|   6669|            40012|              50012|   8779|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-----------------+-------------------+-------+\nTotal line number = 4\nIt costs 0.005s\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br")])])])}),[],!1,null,null,null);n.default=a.exports}}]);