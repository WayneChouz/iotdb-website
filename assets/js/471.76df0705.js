(window.webpackJsonp=window.webpackJsonp||[]).push([[471],{868:function(t,a,e){"use strict";e.r(a);var s=e(29),n=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"集群设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群设置"}},[t._v("#")]),t._v(" 集群设置")]),t._v(" "),a("p",[t._v("本文档为 IoTDB 集群版（0.14.0-preview1）启动教程。")]),t._v(" "),a("h2",{attrs:{id:"安装环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装环境"}},[t._v("#")]),t._v(" 安装环境")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("JDK>=1.8 的运行环境，并配置好 JAVA_HOME 环境变量。")])]),t._v(" "),a("li",[a("p",[t._v("设置最大文件打开数为 65535。")])]),t._v(" "),a("li",[a("p",[t._v("关闭交换内存。")])])]),t._v(" "),a("h2",{attrs:{id:"安装包获取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装包获取"}},[t._v("#")]),t._v(" 安装包获取")]),t._v(" "),a("h3",{attrs:{id:"下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[t._v("#")]),t._v(" 下载")]),t._v(" "),a("p",[t._v("可以直接在官网下载二进制版本 "),a("a",{attrs:{href:"https://iotdb.apache.org/Download/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Download Page"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"源码编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#源码编译"}},[t._v("#")]),t._v(" 源码编译")]),t._v(" "),a("p",[t._v("下载源码:")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("git clone https://github.com/apache/iotdb.git\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("默认分支为 master 分支，你可以切换到发布版本的 tag，例如：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("git checkout v0.14.0-preview1\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("在 IoTDB 根目录下:")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mvn clean package -pl distribution -am -DskipTests\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("集群的二进制版本在目录 "),a("strong",[t._v("distribution/target")]),t._v(" 下，其中，all-bin 包含 ConfigNode 和 DataNode，DataNode 内包含 Cli。")]),t._v(" "),a("h2",{attrs:{id:"安装包说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装包说明"}},[t._v("#")]),t._v(" 安装包说明")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("目录")])]),t._v(" "),a("th",[a("strong",[t._v("说明")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("confignode")]),t._v(" "),a("td",[t._v("包含 ConfigNode 的启停脚本、配置文件、日志、数据")])]),t._v(" "),a("tr",[a("td",[t._v("datanode")]),t._v(" "),a("td",[t._v("包含 DataNode 的启停脚本、配置文件、日志、数据；Cli的启动脚本")])]),t._v(" "),a("tr",[a("td",[t._v("grafana-metrics-example")]),t._v(" "),a("td",[t._v("Grafana 监控界面模板")])]),t._v(" "),a("tr",[a("td",[t._v("lib")]),t._v(" "),a("td",[t._v("库文件目录")])]),t._v(" "),a("tr",[a("td",[t._v("tools")]),t._v(" "),a("td",[t._v("系统工具目录")])])])]),t._v(" "),a("h2",{attrs:{id:"启动集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动集群"}},[t._v("#")]),t._v(" 启动集群")]),t._v(" "),a("p",[t._v("用户可以启动包括若干 ConfigNode 和 DataNode 的集群。\n集群可以提供服务的标准是至少启动一个 ConfigNode 且启动 不小于（数据/元数据）副本个数 的 DataNode。")]),t._v(" "),a("p",[t._v("总体启动流程分为三步")]),t._v(" "),a("ul",[a("li",[t._v("启动种子 ConfigNode")]),t._v(" "),a("li",[t._v("增加 ConfigNode（可选）")]),t._v(" "),a("li",[t._v("增加 DataNode")])]),t._v(" "),a("h3",{attrs:{id:"启动种子-confignode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动种子-confignode"}},[t._v("#")]),t._v(" 启动种子 ConfigNode")]),t._v(" "),a("p",[t._v("对 confignode/conf/iotdb-confignode.properties 中的重要参数进行配置：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("配置项")])]),t._v(" "),a("th",[a("strong",[t._v("说明")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("internal_address")]),t._v(" "),a("td",[t._v("ConfigNode 在集群内部通讯使用的地址")])]),t._v(" "),a("tr",[a("td",[t._v("internal_port")]),t._v(" "),a("td",[t._v("ConfigNode 在集群内部通讯使用的端口")])]),t._v(" "),a("tr",[a("td",[t._v("consensus_port")]),t._v(" "),a("td",[t._v("ConfigNode 副本组共识协议通信使用的端口")])]),t._v(" "),a("tr",[a("td",[t._v("target_config_nodes")]),t._v(" "),a("td",[t._v("种子 ConfigNode 地址，第一个 ConfigNode 配置自己的 address:port")])]),t._v(" "),a("tr",[a("td",[t._v("data_replication_factor")]),t._v(" "),a("td",[t._v("数据副本数，DataNode 数量不应少于此数目")])]),t._v(" "),a("tr",[a("td",[t._v("data_region_consensus_protocol_class")]),t._v(" "),a("td",[t._v("数据副本组的共识协议")])]),t._v(" "),a("tr",[a("td",[t._v("schema_replication_factor")]),t._v(" "),a("td",[t._v("元数据副本数，DataNode 数量不应少于此数目")])]),t._v(" "),a("tr",[a("td",[t._v("schema_region_consensus_protocol_class")]),t._v(" "),a("td",[t._v("元数据副本组的共识协议")])])])]),t._v(" "),a("p",[t._v("Linux 启动方式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 前台启动\n./confignode/sbin/start-confignode.sh\n\n# 后台启动\nnohup ./confignode/sbin/start-confignode.sh >/dev/null 2>&1 &\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("Windows 启动方式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("confignode\\sbin\\start-confignode.bat\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("具体参考 "),a("a",{attrs:{href:"https://iotdb.apache.org/zh/UserGuide/Master/Reference/ConfigNode-Config-Manual.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ConfigNode配置参数"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"增加-confignode-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#增加-confignode-可选"}},[t._v("#")]),t._v(" 增加 ConfigNode（可选）")]),t._v(" "),a("p",[t._v("增加 ConfigNode 是一个扩容操作，除端口不能冲突外，其他参数需要与集群已有的 ConfigNode 保持一致，并将 config_nodes 配置为集群已有节点。")]),t._v(" "),a("p",[t._v("启动方式同上。")]),t._v(" "),a("h3",{attrs:{id:"增加-datanode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#增加-datanode"}},[t._v("#")]),t._v(" 增加 DataNode")]),t._v(" "),a("p",[t._v("可以像集群中添加任意个 DataNode。")]),t._v(" "),a("p",[t._v("iotdb-datanode.properties 中的重要配置如下")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("配置项")])]),t._v(" "),a("th",[a("strong",[t._v("说明")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("rpc_address")]),t._v(" "),a("td",[t._v("客户端 RPC 服务的地址")])]),t._v(" "),a("tr",[a("td",[t._v("rpc_port")]),t._v(" "),a("td",[t._v("客户端 RPC 服务的端口")])]),t._v(" "),a("tr",[a("td",[t._v("internal_address")]),t._v(" "),a("td",[t._v("DataNode 在集群内部接收控制流使用的端口")])]),t._v(" "),a("tr",[a("td",[t._v("internal_port")]),t._v(" "),a("td",[t._v("DataNode 在集群内部接收控制流使用的端口")])]),t._v(" "),a("tr",[a("td",[t._v("mpp_data_exchange_port")]),t._v(" "),a("td",[t._v("DataNode 在集群内部接收数据流使用的端口")])]),t._v(" "),a("tr",[a("td",[t._v("data_region_consensus_port")]),t._v(" "),a("td",[t._v("DataNode 的数据副本间共识协议通信的端口")])]),t._v(" "),a("tr",[a("td",[t._v("schema_region_consensus_port")]),t._v(" "),a("td",[t._v("DataNode 的元数据副本间共识协议通信的端口")])]),t._v(" "),a("tr",[a("td",[t._v("target_config_nodes")]),t._v(" "),a("td",[t._v("集群中正在运行的 ConfigNode 地址")])])])]),t._v(" "),a("p",[t._v("Linux 启动方式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 前台启动\n./datanode/sbin/start-datanode.sh\n\n# 后台启动\nnohup ./datanode/sbin/start-datanode.sh >/dev/null 2>&1 &\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("Windows 启动方式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("datanode\\sbin\\start-datanode.bat\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("具体参考 "),a("a",{attrs:{href:"https://iotdb.apache.org/zh/UserGuide/Master/Reference/DataNode-Config-Manual.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("DataNode配置参数"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"启动-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-cli"}},[t._v("#")]),t._v(" 启动 Cli")]),t._v(" "),a("p",[t._v("Cli 启动脚本在 datanode/sbin 目录")]),t._v(" "),a("p",[t._v("Linux 启动方式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("./datanode/sbin/start-cli.sh\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("Windows 启动方式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("datanode\\sbin\\start-cli.bat\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h2",{attrs:{id:"快速上手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速上手"}},[t._v("#")]),t._v(" 快速上手")]),t._v(" "),a("p",[t._v("解压 apache-iotdb-0.14.0-preview1-all-bin.zip")]),t._v(" "),a("p",[t._v("部署 1 个 ConfigNode 和 1 个 DataNode（1C1D）集群版，默认 1 副本。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("./confignode/sbin/start-confignode.sh\n./datanode/sbin/start-datanode.sh\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("启动 Cli")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("./datanode/sbin/start-cli.sh\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);