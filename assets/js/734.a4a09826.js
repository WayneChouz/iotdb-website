(window.webpackJsonp=window.webpackJsonp||[]).push([[734],{1139:function(s,t,n){"use strict";n.r(t);var a=n(19),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"快速上手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速上手"}},[s._v("#")]),s._v(" 快速上手")]),s._v(" "),t("p",[s._v("以本地环境为例，演示 IoTDB 集群的启动、扩容与缩容。")]),s._v(" "),t("p",[t("strong",[s._v("注意：本文档为使用本地不同端口，进行伪分布式环境部署的教程，仅用于练习。在真实环境部署时，一般不需要修改节点端口，仅需配置节点 IPV4 地址或域名即可。")])]),s._v(" "),t("h2",{attrs:{id:"_1-准备启动环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-准备启动环境"}},[s._v("#")]),s._v(" 1. 准备启动环境")]),s._v(" "),t("p",[s._v("解压 apache-iotdb-1.0.0-all-bin.zip 至 cluster0 目录。")]),s._v(" "),t("h2",{attrs:{id:"_2-启动最小集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动最小集群"}},[s._v("#")]),s._v(" 2. 启动最小集群")]),s._v(" "),t("p",[s._v("在 Linux 环境中，部署 1 个 ConfigNode 和 1 个 DataNode（1C1D）集群版，默认 1 副本：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./cluster0/sbin/start-confignode.sh\n./cluster0/sbin/start-datanode.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"_3-验证最小集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-验证最小集群"}},[s._v("#")]),s._v(" 3. 验证最小集群")]),s._v(" "),t("ul",[t("li",[s._v("最小集群启动成功，启动 Cli 进行验证：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./cluster0/sbin/start-cli.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("在 Cli 执行 "),t("a",{attrs:{href:"https://iotdb.apache.org/zh/UserGuide/Master/Maintenance-Tools/Maintenance-Command.html#%E6%9F%A5%E7%9C%8B%E5%85%A8%E9%83%A8%E8%8A%82%E7%82%B9%E4%BF%A1%E6%81%AF",target:"_blank",rel:"noopener noreferrer"}},[s._v("show cluster details"),t("OutboundLink")],1),s._v("\n指令，结果如下所示：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("IoTDB> show cluster details\n+------+----------+-------+---------------+------------+-------------------+----------+-------+--------+-------------------+-----------------+\n|NodeID|  NodeType| Status|InternalAddress|InternalPort|ConfigConsensusPort|RpcAddress|RpcPort|MppPort |SchemaConsensusPort|DataConsensusPort|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+--------+-------------------+-----------------+\n|     0|ConfigNode|Running|      127.0.0.1|       10710|              10720|          |       |        |                   |                 |\n|     1|  DataNode|Running|      127.0.0.1|       10730|                   | 127.0.0.1|   6667|   10740|              10750|            10760|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+--------+-------------------+-----------------+\nTotal line number = 2\nIt costs 0.242s\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"_4-准备扩容环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-准备扩容环境"}},[s._v("#")]),s._v(" 4. 准备扩容环境")]),s._v(" "),t("p",[s._v("解压 apache-iotdb-1.0.0-all-bin.zip 至 cluster1 目录和 cluster2 目录")]),s._v(" "),t("h2",{attrs:{id:"_5-修改节点配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改节点配置文件"}},[s._v("#")]),s._v(" 5. 修改节点配置文件")]),s._v(" "),t("p",[s._v("对于 cluster1 目录：")]),s._v(" "),t("ul",[t("li",[s._v("修改 ConfigNode 配置：")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("配置项")])]),s._v(" "),t("th",[t("strong",[s._v("值")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("cn_internal_address")]),s._v(" "),t("td",[s._v("127.0.0.1")])]),s._v(" "),t("tr",[t("td",[s._v("cn_internal_port")]),s._v(" "),t("td",[s._v("10711")])]),s._v(" "),t("tr",[t("td",[s._v("cn_consensus_port")]),s._v(" "),t("td",[s._v("10721")])]),s._v(" "),t("tr",[t("td",[s._v("cn_target_config_node_list")]),s._v(" "),t("td",[s._v("127.0.0.1:10710")])])])]),s._v(" "),t("ul",[t("li",[s._v("修改 DataNode 配置：")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("配置项")])]),s._v(" "),t("th",[t("strong",[s._v("值")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("dn_rpc_address")]),s._v(" "),t("td",[s._v("127.0.0.1")])]),s._v(" "),t("tr",[t("td",[s._v("dn_rpc_port")]),s._v(" "),t("td",[s._v("6668")])]),s._v(" "),t("tr",[t("td",[s._v("dn_internal_address")]),s._v(" "),t("td",[s._v("127.0.0.1")])]),s._v(" "),t("tr",[t("td",[s._v("dn_internal_port")]),s._v(" "),t("td",[s._v("10731")])]),s._v(" "),t("tr",[t("td",[s._v("dn_mpp_data_exchange_port")]),s._v(" "),t("td",[s._v("10741")])]),s._v(" "),t("tr",[t("td",[s._v("dn_schema_region_consensus_port")]),s._v(" "),t("td",[s._v("10751")])]),s._v(" "),t("tr",[t("td",[s._v("dn_data_region_consensus_port")]),s._v(" "),t("td",[s._v("10761")])]),s._v(" "),t("tr",[t("td",[s._v("dn_target_config_node_list")]),s._v(" "),t("td",[s._v("127.0.0.1:10710")])])])]),s._v(" "),t("p",[s._v("对于 cluster2 目录：")]),s._v(" "),t("ul",[t("li",[s._v("修改 ConfigNode 配置：")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("配置项")])]),s._v(" "),t("th",[t("strong",[s._v("值")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("cn_internal_address")]),s._v(" "),t("td",[s._v("127.0.0.1")])]),s._v(" "),t("tr",[t("td",[s._v("cn_internal_port")]),s._v(" "),t("td",[s._v("10712")])]),s._v(" "),t("tr",[t("td",[s._v("cn_consensus_port")]),s._v(" "),t("td",[s._v("10722")])]),s._v(" "),t("tr",[t("td",[s._v("cn_target_config_node_list")]),s._v(" "),t("td",[s._v("127.0.0.1:10710")])])])]),s._v(" "),t("ul",[t("li",[s._v("修改 DataNode 配置：")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("配置项")])]),s._v(" "),t("th",[t("strong",[s._v("值")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("dn_rpc_address")]),s._v(" "),t("td",[s._v("127.0.0.1")])]),s._v(" "),t("tr",[t("td",[s._v("dn_rpc_port")]),s._v(" "),t("td",[s._v("6669")])]),s._v(" "),t("tr",[t("td",[s._v("dn_internal_address")]),s._v(" "),t("td",[s._v("127.0.0.1")])]),s._v(" "),t("tr",[t("td",[s._v("dn_internal_port")]),s._v(" "),t("td",[s._v("10732")])]),s._v(" "),t("tr",[t("td",[s._v("dn_mpp_data_exchange_port")]),s._v(" "),t("td",[s._v("10742")])]),s._v(" "),t("tr",[t("td",[s._v("dn_schema_region_consensus_port")]),s._v(" "),t("td",[s._v("10752")])]),s._v(" "),t("tr",[t("td",[s._v("dn_data_region_consensus_port")]),s._v(" "),t("td",[s._v("10762")])]),s._v(" "),t("tr",[t("td",[s._v("dn_target_config_node_list")]),s._v(" "),t("td",[s._v("127.0.0.1:10710")])])])]),s._v(" "),t("h2",{attrs:{id:"_6-集群扩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-集群扩容"}},[s._v("#")]),s._v(" 6. 集群扩容")]),s._v(" "),t("p",[s._v("将集群扩容至 3 个 ConfigNode 和 3 个 DataNode（3C3D）集群版，\n指令执行顺序为先启动 ConfigNode，再启动 DataNode：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./cluster1/sbin/start-confignode.sh\n./cluster2/sbin/start-confignode.sh\n./cluster1/sbin/start-datanode.sh\n./cluster2/sbin/start-datanode.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_7-验证扩容结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-验证扩容结果"}},[s._v("#")]),s._v(" 7. 验证扩容结果")]),s._v(" "),t("p",[s._v("在 Cli 执行 "),t("code",[s._v("show cluster details")]),s._v("，结果如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("IoTDB> show cluster details\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-------+-------------------+-----------------+\n|NodeID|  NodeType| Status|InternalAddress|InternalPort|ConfigConsensusPort|RpcAddress|RpcPort|MppPort|SchemaConsensusPort|DataConsensusPort|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-------+-------------------+-----------------+\n|     0|ConfigNode|Running|      127.0.0.1|       10710|              10720|          |       |       |                   |                 |\n|     2|ConfigNode|Running|      127.0.0.1|       10711|              10721|          |       |       |                   |                 |\n|     3|ConfigNode|Running|      127.0.0.1|       10712|              10722|          |       |       |                   |                 |\n|     1|  DataNode|Running|      127.0.0.1|       10730|                   | 127.0.0.1|   6667|  10740|              10750|            10760|\n|     4|  DataNode|Running|      127.0.0.1|       10731|                   | 127.0.0.1|   6668|  10741|              10751|            10761|\n|     5|  DataNode|Running|      127.0.0.1|       10732|                   | 127.0.0.1|   6669|  10742|              10752|            10762|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-------+-------------------+-----------------+\nTotal line number = 6\nIt costs 0.012s\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h2",{attrs:{id:"_8-集群缩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-集群缩容"}},[s._v("#")]),s._v(" 8. 集群缩容")]),s._v(" "),t("ul",[t("li",[s._v("缩容一个 ConfigNode：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 使用 ip:port 移除\n./cluster0/sbin/remove-confignode.sh 127.0.0.1:10711\n\n# 使用节点编号移除\n./cluster0/sbin/remove-confignode.sh 2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("缩容一个 DataNode：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 使用 ip:port 移除\n./cluster0/sbin/remove-datanode.sh 127.0.0.1:6668\n\n# 使用节点编号移除\n./cluster0/sbin/remove-confignode.sh 4\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"_9-验证缩容结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-验证缩容结果"}},[s._v("#")]),s._v(" 9. 验证缩容结果")]),s._v(" "),t("p",[s._v("在 Cli 执行 "),t("code",[s._v("show cluster details")]),s._v("，结果如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("IoTDB> show cluster details\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-------+-------------------+-----------------+\n|NodeID|  NodeType| Status|InternalAddress|InternalPort|ConfigConsensusPort|RpcAddress|RpcPort|MppPort|SchemaConsensusPort|DataConsensusPort|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-------+-------------------+-----------------+\n|     0|ConfigNode|Running|      127.0.0.1|       10710|              10720|          |       |       |                   |                 |\n|     3|ConfigNode|Running|      127.0.0.1|       10712|              10722|          |       |       |                   |                 |\n|     1|  DataNode|Running|      127.0.0.1|       10730|                   | 127.0.0.1|   6667|  10740|              10750|            10760|\n|     5|  DataNode|Running|      127.0.0.1|       10732|                   | 127.0.0.1|   6669|  10742|              10752|            10762|\n+------+----------+-------+---------------+------------+-------------------+----------+-------+-------+-------------------+-----------------+\nTotal line number = 4\nIt costs 0.005s\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);