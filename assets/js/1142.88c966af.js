(window.webpackJsonp=window.webpackJsonp||[]).push([[1142],{1546:function(_,t,e){"use strict";e.r(t);var v=e(19),a=Object(v.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("p",[_._v("在 IoTDB 的运行过程中，我们希望对 IoTDB 的状态进行观测，以便于排查系统问题或者及时发现系统潜在的风险，能够"),t("strong",[_._v("反映系统运行状态的一系列指标")]),_._v("就是系统监控指标。")]),_._v(" "),t("h2",{attrs:{id:"_1-什么场景下会使用到监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么场景下会使用到监控"}},[_._v("#")]),_._v(" 1. 什么场景下会使用到监控?")]),_._v(" "),t("p",[_._v("那么什么时候会用到监控框架呢？下面列举一些常见的场景。")]),_._v(" "),t("ol",[t("li",[t("p",[_._v("系统变慢了")]),_._v(" "),t("p",[_._v("系统变慢几乎是最常见也最头疼的问题，这时候我们需要尽可能多的信息来帮助我们找到系统变慢的原因，比如：")]),_._v(" "),t("ul",[t("li",[_._v("JVM信息：是不是有FGC？GC耗时多少？GC后内存有没有恢复？是不是有大量的线程？")]),_._v(" "),t("li",[_._v("系统信息：CPU使用率是不是太高了？磁盘IO是不是很频繁？")]),_._v(" "),t("li",[_._v("连接数：当前连接是不是太多？")]),_._v(" "),t("li",[_._v("接口：当前TPS是多少？各个接口耗时有没有变化？")]),_._v(" "),t("li",[_._v("线程池：系统中各种任务是否有积压？")]),_._v(" "),t("li",[_._v("缓存命中率")])])]),_._v(" "),t("li",[t("p",[_._v("磁盘快满了")]),_._v(" "),t("p",[_._v("这时候我们迫切想知道最近一段时间数据文件的增长情况，看看是不是某种文件有突增。")])]),_._v(" "),t("li",[t("p",[_._v("系统运行是否正常")]),_._v(" "),t("p",[_._v("此时我们可能需要通过错误日志的数量、集群节点的状态等指标来判断系统是否在正常运行。")])])]),_._v(" "),t("h2",{attrs:{id:"_2-什么人需要使用监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-什么人需要使用监控"}},[_._v("#")]),_._v(" 2. 什么人需要使用监控?")]),_._v(" "),t("p",[_._v("所有关注系统状态的人员都可以使用，包括但不限于研发、测试、运维、DBA等等")]),_._v(" "),t("h2",{attrs:{id:"_3-什么是监控指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-什么是监控指标"}},[_._v("#")]),_._v(" 3. 什么是监控指标？")]),_._v(" "),t("h3",{attrs:{id:"_3-1-监控指标名词解释"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-监控指标名词解释"}},[_._v("#")]),_._v(" 3.1. 监控指标名词解释")]),_._v(" "),t("p",[_._v("在 IoTDB 的监控模块，每个监控指标被 "),t("code",[_._v("Metric Name")]),_._v(" 和 "),t("code",[_._v("Tags")]),_._v(" 唯一标识。")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("Metric Name")]),_._v("：指标类型名称，比如"),t("code",[_._v("logback_events")]),_._v("表示日志事件。")]),_._v(" "),t("li",[t("code",[_._v("Tags")]),_._v("：指标分类，形式为Key-Value对，每个指标下面可以有0到多个分类，常见的Key-Value对：\n"),t("ul",[t("li",[t("code",[_._v("name = xxx")]),_._v("：被监控对象的名称，是对"),t("strong",[_._v("业务逻辑")]),_._v("的说明。比如对于"),t("code",[_._v("Metric Name = entry_seconds_count")]),_._v("类型的监控项，name的含义是指被监控的业务接口。")]),_._v(" "),t("li",[t("code",[_._v("type = xxx")]),_._v("：监控指标类型细分，是对"),t("strong",[_._v("监控指标")]),_._v("本身的说明。比如对于"),t("code",[_._v("Metric Name = point")]),_._v("类型的监控项，type的含义是指监控具体是什么类型的点数。")]),_._v(" "),t("li",[t("code",[_._v("status = xxx")]),_._v("：被监控对象的状态，是对"),t("strong",[_._v("业务逻辑")]),_._v("的说明。比如对于"),t("code",[_._v("Metric Name = Task")]),_._v("类型的监控项可以通过该参数，从而区分被监控对象的状态。")]),_._v(" "),t("li",[t("code",[_._v("user = xxx")]),_._v("：被监控对象的相关用户，是对"),t("strong",[_._v("业务逻辑")]),_._v("的说明。比如统计"),t("code",[_._v("root")]),_._v("用户的写入总点数。")]),_._v(" "),t("li",[_._v("根据具体情况自定义：比如logback_events_total下有一个level的分类，用来表示特定级别下的日志数量。")])])]),_._v(" "),t("li",[t("code",[_._v("Metric Level")]),_._v("："),t("strong",[_._v("指标管理级别")]),_._v("，默认启动级别为"),t("code",[_._v("Core")]),_._v("级别，建议启动级别为"),t("code",[_._v("Important级别")]),_._v("，审核严格程度"),t("code",[_._v("Core > Important > Normal > All")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("Core")]),_._v("：系统的核心指标，供"),t("strong",[_._v("系统内核和运维人员")]),_._v("使用，关乎系统的"),t("strong",[_._v("性能、稳定性、安全性")]),_._v("，比如实例的状况，系统的负载等。")]),_._v(" "),t("li",[t("code",[_._v("Important")]),_._v("：模块的重要指标，供"),t("strong",[_._v("运维和测试人员")]),_._v("使用，直接关乎"),t("strong",[_._v("每个模块的运行状态")]),_._v("，比如合并文件个数、执行情况等。")]),_._v(" "),t("li",[t("code",[_._v("Normal")]),_._v("：模块的一般指标，供"),t("strong",[_._v("开发人员")]),_._v("使用，方便在出现问题时"),t("strong",[_._v("定位模块")]),_._v("，比如合并中的特定关键操作情况。")]),_._v(" "),t("li",[t("code",[_._v("All")]),_._v("：模块的全部指标，供"),t("strong",[_._v("模块开发人员")]),_._v("使用，往往在复现问题的时候使用，从而快速解决问题。")])])])]),_._v(" "),t("h3",{attrs:{id:"_3-2-监控指标对外获取数据格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-监控指标对外获取数据格式"}},[_._v("#")]),_._v(" 3.2. 监控指标对外获取数据格式")]),_._v(" "),t("ul",[t("li",[_._v("IoTDB 对外提供 JMX、 Prometheus 和 IoTDB 格式的监控指标：\n"),t("ul",[t("li",[_._v("对于 JMX ，可以通过"),t("code",[_._v("org.apache.iotdb.metrics")]),_._v("获取系统监控指标指标。")]),_._v(" "),t("li",[_._v("对于 Prometheus ，可以通过对外暴露的端口获取监控指标的值")]),_._v(" "),t("li",[_._v("对于 IoTDB 方式对外暴露：可以通过执行 IoTDB 的查询来获取监控指标")])])])]),_._v(" "),t("h2",{attrs:{id:"_4-监控指标有哪些"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-监控指标有哪些"}},[_._v("#")]),_._v(" 4. 监控指标有哪些？")]),_._v(" "),t("p",[_._v("目前，IoTDB 对外提供一些主要模块的监控指标，并且随着新功能的开发以及系统优化或者重构，监控指标也会同步添加和更新。如果想自己在 IoTDB 中添加更多系统监控指标埋点，可以参考"),t("a",{attrs:{href:"https://github.com/apache/iotdb/tree/master/metrics",target:"_blank",rel:"noopener noreferrer"}},[_._v("IoTDB Metrics Framework"),t("OutboundLink")],1),_._v("使用说明。")]),_._v(" "),t("h3",{attrs:{id:"_4-1-core-级别监控指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-core-级别监控指标"}},[_._v("#")]),_._v(" 4.1. Core 级别监控指标")]),_._v(" "),t("p",[_._v("Core 级别的监控指标在系统运行中默认开启，每一个 Core 级别的监控指标的添加都需要经过谨慎的评估，目前 Core 级别的监控指标如下所述：")]),_._v(" "),t("h4",{attrs:{id:"_4-1-1-集群运行状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-集群运行状态"}},[_._v("#")]),_._v(" 4.1.1. 集群运行状态")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("config_node")]),_._v(" "),t("td",[_._v('name="total",status="Registered/Online/Unknown"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("已注册/在线/离线 confignode 的节点数量")])]),_._v(" "),t("tr",[t("td",[_._v("data_node")]),_._v(" "),t("td",[_._v('name="total",status="Registered/Online/Unknown"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("已注册/在线/离线 datanode 的节点数量")])]),_._v(" "),t("tr",[t("td",[_._v("points")]),_._v(" "),t("td",[_._v('database="'+_._s(_.database)+'", type="flush"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("最新一个刷盘的memtale的点数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-1-2-iotdb-进程运行状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-iotdb-进程运行状态"}},[_._v("#")]),_._v(" 4.1.2. IoTDB 进程运行状态")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("process_cpu_load")]),_._v(" "),t("td",[_._v('name="process"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程的 CPU 占用率，单位为%")])]),_._v(" "),t("tr",[t("td",[_._v("process_cpu_time")]),_._v(" "),t("td",[_._v('name="process"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程占用的 CPU 时间，单位为ns")])]),_._v(" "),t("tr",[t("td",[_._v("process_max_mem")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程最大可用内存")])]),_._v(" "),t("tr",[t("td",[_._v("process_total_mem")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程当前已申请内存")])]),_._v(" "),t("tr",[t("td",[_._v("process_free_mem")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程当前剩余可用内存")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-1-3-系统运行状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-系统运行状态"}},[_._v("#")]),_._v(" 4.1.3. 系统运行状态")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("sys_cpu_load")]),_._v(" "),t("td",[_._v('name="system"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统的 CPU 占用率，单位为%")])]),_._v(" "),t("tr",[t("td",[_._v("sys_cpu_cores")]),_._v(" "),t("td",[_._v('name="system"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("系统的可用处理器数")])]),_._v(" "),t("tr",[t("td",[_._v("sys_total_physical_memory_size")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("系统的最大物理内存")])]),_._v(" "),t("tr",[t("td",[_._v("sys_free_physical_memory_size")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统的剩余可用内存")])]),_._v(" "),t("tr",[t("td",[_._v("sys_total_swap_space_size")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统的交换区最大空间")])]),_._v(" "),t("tr",[t("td",[_._v("sys_free_swap_space_size")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统的交换区剩余可用空间")])]),_._v(" "),t("tr",[t("td",[_._v("sys_committed_vm_size")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统保证可用于正在运行的进程的虚拟内存量")])]),_._v(" "),t("tr",[t("td",[_._v("sys_disk_total_space")]),_._v(" "),t("td",[_._v('name="disk"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统磁盘总大小")])]),_._v(" "),t("tr",[t("td",[_._v("sys_disk_free_space")]),_._v(" "),t("td",[_._v('name="disk"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统磁盘可用大小")])])])]),_._v(" "),t("h3",{attrs:{id:"_4-2-important-级别监控指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-important-级别监控指标"}},[_._v("#")]),_._v(" 4.2. Important 级别监控指标")]),_._v(" "),t("p",[_._v("目前 Important 级别的监控指标如下所述：")]),_._v(" "),t("h4",{attrs:{id:"_4-2-1-集群运行状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-集群运行状态"}},[_._v("#")]),_._v(" 4.2.1. 集群运行状态")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("cluster_node_leader_count")]),_._v(" "),t("td",[_._v('name="'+_._s(_.ip)+":"+_._s(_.port)+'"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("节点上共识组Leader的数量")])]),_._v(" "),t("tr",[t("td",[_._v("cluster_node_status")]),_._v(" "),t("td",[_._v('name="'+_._s(_.ip)+":"+_._s(_.port)+'",type="ConfigNode/DataNode"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("节点的状态，0=Unkonwn 1=online")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-2-节点统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-节点统计"}},[_._v("#")]),_._v(" 4.2.2. 节点统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("quantity")]),_._v(" "),t("td",[_._v('name="database"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统数据库数量")])]),_._v(" "),t("tr",[t("td",[_._v("quantity")]),_._v(" "),t("td",[_._v('name="timeSeries"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("系统时间序列数量")])]),_._v(" "),t("tr",[t("td",[_._v("quantity")]),_._v(" "),t("td",[_._v('name="pointsIn"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("系统累计写入点数")])]),_._v(" "),t("tr",[t("td",[_._v("region")]),_._v(" "),t("td",[_._v('name="total",type="SchemaRegion"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("分区表中 SchemaRegion 总数量")])]),_._v(" "),t("tr",[t("td",[_._v("region")]),_._v(" "),t("td",[_._v('name="total",type="DataRegion"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("分区表中 DataRegion 总数量")])]),_._v(" "),t("tr",[t("td",[_._v("region")]),_._v(" "),t("td",[_._v('name="'+_._s(_.ip)+":"+_._s(_.port)+'",type="SchemaRegion"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("分区表中对应节点上 DataRegion 总数量")])]),_._v(" "),t("tr",[t("td",[_._v("region")]),_._v(" "),t("td",[_._v('name="'+_._s(_.ip)+":"+_._s(_.port)+'",type="DataRegion"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("分区表中对应节点上 DataRegion 总数量")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-3-iot共识协议统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-iot共识协议统计"}},[_._v("#")]),_._v(" 4.2.3. IoT共识协议统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("iot_consensus")]),_._v(" "),t("td",[_._v('name="logDispatcher-'+_._s(_.IP)+":"+_._s(_.Port)+'", region="'+_._s(_.region)+'", type="currentSyncIndex"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("副本组同步线程的当前同步进度")])]),_._v(" "),t("tr",[t("td",[_._v("iot_consensus")]),_._v(" "),t("td",[_._v('name="logDispatcher-'+_._s(_.IP)+":"+_._s(_.Port)+'", region="'+_._s(_.region)+'", type="cachedRequestInMemoryQueue"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("副本组同步线程缓存队列请求总大小")])]),_._v(" "),t("tr",[t("td",[_._v("iot_consensus")]),_._v(" "),t("td",[_._v('name="IoTConsensusServerImpl", region="'+_._s(_.region)+'", type="searchIndex"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("副本组主流程写入进度")])]),_._v(" "),t("tr",[t("td",[_._v("iot_consensus")]),_._v(" "),t("td",[_._v('name="IoTConsensusServerImpl", region="'+_._s(_.region)+'", type="safeIndex"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("副本组同步进度")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="getStateMachineLock"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("主流程获取状态机锁耗时")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="checkingBeforeWrite"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("主流程写入状态机检查耗时")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="writeStateMachine"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("主流程写入状态机耗时")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="offerRequestToQueue"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("主流程尝试添加队列耗时")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="consensusWrite"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("主流程全写入耗时")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="constructBatch"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("同步线程构造 Batch 耗时")])]),_._v(" "),t("tr",[t("td",[_._v("stage")]),_._v(" "),t("td",[_._v('name="iot_consensus", region="'+_._s(_.region)+'", type="syncLogTimePerRequest"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("异步回调流程同步日志耗时")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-4-缓存统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-缓存统计"}},[_._v("#")]),_._v(" 4.2.4. 缓存统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("cache_hit")]),_._v(" "),t("td",[_._v('name="chunk"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("ChunkCache的命中率，单位为%")])]),_._v(" "),t("tr",[t("td",[_._v("cache_hit")]),_._v(" "),t("td",[_._v('name="schema"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("SchemaCache的命中率，单位为%")])]),_._v(" "),t("tr",[t("td",[_._v("cache_hit")]),_._v(" "),t("td",[_._v('name="timeSeriesMeta"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("TimeseriesMetadataCache的命中率，单位为%")])]),_._v(" "),t("tr",[t("td",[_._v("cache_hit")]),_._v(" "),t("td",[_._v('name="bloomFilter"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("TimeseriesMetadataCache中的bloomFilter的拦截率，单位为%")])]),_._v(" "),t("tr",[t("td",[_._v("cache")]),_._v(" "),t("td",[_._v('name="Database", type="hit"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("Database Cache 的命中次数")])]),_._v(" "),t("tr",[t("td",[_._v("cache")]),_._v(" "),t("td",[_._v('name="Database", type="all"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("Database Cache 的访问次数")])]),_._v(" "),t("tr",[t("td",[_._v("cache")]),_._v(" "),t("td",[_._v('name="SchemaPartition", type="hit"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("SchemaPartition Cache 的命中次数")])]),_._v(" "),t("tr",[t("td",[_._v("cache")]),_._v(" "),t("td",[_._v('name="SchemaPartition", type="all"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("SchemaPartition Cache 的访问次数")])]),_._v(" "),t("tr",[t("td",[_._v("cache")]),_._v(" "),t("td",[_._v('name="DataPartition", type="hit"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("DataPartition Cache 的命中次数")])]),_._v(" "),t("tr",[t("td",[_._v("cache")]),_._v(" "),t("td",[_._v('name="DataPartition", type="all"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("DataPartition Cache 的访问次数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-5-接口层统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-接口层统计"}},[_._v("#")]),_._v(" 4.2.5. 接口层统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("operation")]),_._v(" "),t("td",[_._v('name = "'+_._s(_.name)+'"')]),_._v(" "),t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("客户端执行的操作的耗时情况")])]),_._v(" "),t("tr",[t("td",[_._v("entry")]),_._v(" "),t("td",[_._v('name="'+_._s(_.interface)+'"')]),_._v(" "),t("td",[_._v("Timer")]),_._v(" "),t("td",[_._v("Client 建立的 Thrift 的耗时情况")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_connections")]),_._v(" "),t("td",[_._v('name="ConfigNodeRPC"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("ConfigNode 的内部 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_connections")]),_._v(" "),t("td",[_._v('name="Internal"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("DataNode 的内部 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_connections")]),_._v(" "),t("td",[_._v('name="MPPDataExchange"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("MPP 框架的内部 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_connections")]),_._v(" "),t("td",[_._v('name="RPC"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("Client 建立的 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_active_threads")]),_._v(" "),t("td",[_._v('name="ConfigNodeRPC-Service"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("ConfigNode 的内部活跃 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_active_threads")]),_._v(" "),t("td",[_._v('name="DataNodeInternalRPC-Service"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("DataNode 的内部活跃 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_active_threads")]),_._v(" "),t("td",[_._v('name="MPPDataExchangeRPC-Service"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("MPP 框架的内部活跃 Thrift 连接数")])]),_._v(" "),t("tr",[t("td",[_._v("thrift_active_threads")]),_._v(" "),t("td",[_._v('name="ClientRPC-Service"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("Client 建立的活跃 Thrift 连接数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-6-内存统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-6-内存统计"}},[_._v("#")]),_._v(" 4.2.6. 内存统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("mem")]),_._v(" "),t("td",[_._v('name="database_'+_._s(_.name)+'"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("DataNode内对应DataRegion的内存占用，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("mem")]),_._v(" "),t("td",[_._v('name="chunkMetaData_'+_._s(_.name)+'"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("写入TsFile时的ChunkMetaData的内存占用，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("mem")]),_._v(" "),t("td",[_._v('name="IoTConsensus"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoT共识协议的内存占用，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("mem")]),_._v(" "),t("td",[_._v('name="schema_region_total_usage"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("所有SchemaRegion的总内存占用，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("mem")]),_._v(" "),t("td",[_._v('name="schema_region_total_remaining"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("所有SchemaRegion的总内存剩余，单位为byte")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-7-任务统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-7-任务统计"}},[_._v("#")]),_._v(" 4.2.7. 任务统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("queue")]),_._v(" "),t("td",[_._v('name="compaction_inner", status="running/waiting"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("空间内合并任务数")])]),_._v(" "),t("tr",[t("td",[_._v("queue")]),_._v(" "),t("td",[_._v('name="compaction_cross", status="running/waiting"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("跨空间合并任务数")])]),_._v(" "),t("tr",[t("td",[_._v("cost_task")]),_._v(" "),t("td",[_._v('name="inner_compaction/cross_compaction/flush"')]),_._v(" "),t("td",[_._v("Gauge")]),_._v(" "),t("td",[_._v("任务耗时情况")])]),_._v(" "),t("tr",[t("td",[_._v("queue")]),_._v(" "),t("td",[_._v('name="flush",status="running/waiting"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("刷盘任务数")])]),_._v(" "),t("tr",[t("td",[_._v("queue")]),_._v(" "),t("td",[_._v('name="Sub_RawQuery",status="running/waiting"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("Sub_RawQuery任务数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-8-合并统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-8-合并统计"}},[_._v("#")]),_._v(" 4.2.8. 合并统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("data_written")]),_._v(" "),t("td",[_._v('name="compaction", type="aligned/not-aligned/total"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("合并时写入量")])]),_._v(" "),t("tr",[t("td",[_._v("data_read")]),_._v(" "),t("td",[_._v('name="compaction"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("合并时的读取量")])]),_._v(" "),t("tr",[t("td",[_._v("compaction_task_count")]),_._v(" "),t("td",[_._v('name = "inner_compaction", type="sequence"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("顺序空间内合并次数")])]),_._v(" "),t("tr",[t("td",[_._v("compaction_task_count")]),_._v(" "),t("td",[_._v('name = "inner_compaction", type="unsequence"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("乱序空间内合并次数")])]),_._v(" "),t("tr",[t("td",[_._v("compaction_task_count")]),_._v(" "),t("td",[_._v('name = "cross_compaction", type="cross"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("跨空间合并次数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-9-文件统计信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-9-文件统计信息"}},[_._v("#")]),_._v(" 4.2.9. 文件统计信息")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("file_size")]),_._v(" "),t("td",[_._v('name="wal"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("写前日志总大小，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("file_size")]),_._v(" "),t("td",[_._v('name="seq"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("顺序TsFile总大小，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("file_size")]),_._v(" "),t("td",[_._v('name="unseq"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("乱序TsFile总大小，单位为byte")])]),_._v(" "),t("tr",[t("td",[_._v("file_count")]),_._v(" "),t("td",[_._v('name="wal"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("写前日志文件个数")])]),_._v(" "),t("tr",[t("td",[_._v("file_count")]),_._v(" "),t("td",[_._v('name="seq"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("顺序TsFile文件个数")])]),_._v(" "),t("tr",[t("td",[_._v("file_count")]),_._v(" "),t("td",[_._v('name="unseq"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("乱序TsFile文件个数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-10-iotdb-进程统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-10-iotdb-进程统计"}},[_._v("#")]),_._v(" 4.2.10. IoTDB 进程统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("process_used_mem")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程当前使用内存")])]),_._v(" "),t("tr",[t("td",[_._v("process_mem_ratio")]),_._v(" "),t("td",[_._v('name="memory"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程的内存占用比例")])]),_._v(" "),t("tr",[t("td",[_._v("process_threads_count")]),_._v(" "),t("td",[_._v('name="process"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程当前线程数")])]),_._v(" "),t("tr",[t("td",[_._v("process_status")]),_._v(" "),t("td",[_._v('name="process"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("IoTDB 进程存活状态，1为存活，0为终止")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-11-iotdb-日志统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-11-iotdb-日志统计"}},[_._v("#")]),_._v(" 4.2.11. IoTDB 日志统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("logback_events")]),_._v(" "),t("td",[_._v('level="trace/debug/info/warn/error"')]),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("不同类型的日志个数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-12-jvm-线程统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-12-jvm-线程统计"}},[_._v("#")]),_._v(" 4.2.12. JVM 线程统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("jvm_threads_live_threads")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("当前线程数")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_threads_daemon_threads")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("当前 Daemon 线程数")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_threads_peak_threads")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("峰值线程数")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_threads_states_threads")]),_._v(" "),t("td",[_._v('state="runnable/blocked/waiting/timed-waiting/new/terminated"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("当前处于各种状态的线程数")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-13-jvm-gc-统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-13-jvm-gc-统计"}},[_._v("#")]),_._v(" 4.2.13. JVM GC 统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("jvm_gc_pause")]),_._v(" "),t("td",[_._v('action="end of major GC/end of minor GC",cause="xxxx"')]),_._v(" "),t("td",[_._v("Timer")]),_._v(" "),t("td",[_._v("不同原因的Young GC/Full GC的次数与耗时")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td"),_._v(" "),t("td"),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("jvm_gc_concurrent_phase_time")]),_._v(" "),t("td",[_._v('action="'+_._s(_.action)+'",cause="'+_._s(_.cause)+'"')]),_._v(" "),t("td",[_._v("Timer")]),_._v(" "),t("td",[_._v("不同原因的Young GC/Full GC的次数与耗时")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td"),_._v(" "),t("td"),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("jvm_gc_max_data_size_bytes")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("老年代内存的历史最大值")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_gc_live_data_size_bytes")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("老年代内存的使用值")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_gc_memory_promoted_bytes")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("老年代内存正向增长累计值")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_gc_memory_allocated_bytes")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("GC分配内存正向增长累计值")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-14-jvm-内存统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-14-jvm-内存统计"}},[_._v("#")]),_._v(" 4.2.14. JVM 内存统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("jvm_buffer_memory_used_bytes")]),_._v(" "),t("td",[_._v('id="direct/mapped"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("已经使用的缓冲区大小")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_buffer_total_capacity_bytes")]),_._v(" "),t("td",[_._v('id="direct/mapped"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("最大缓冲区大小")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_buffer_count_buffers")]),_._v(" "),t("td",[_._v('id="direct/mapped"')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("当前缓冲区数量")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_memory_committed_bytes")]),_._v(" "),t("td",[_._v('{area="heap/nonheap",id="xxx",}')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("当前申请的内存大小")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_memory_max_bytes")]),_._v(" "),t("td",[_._v('{area="heap/nonheap",id="xxx",}')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("最大内存")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_memory_used_bytes")]),_._v(" "),t("td",[_._v('{area="heap/nonheap",id="xxx",}')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("已使用内存大小")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-15-jvm-类加载统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-15-jvm-类加载统计"}},[_._v("#")]),_._v(" 4.2.15. JVM 类加载统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("jvm_classes_unloaded_classes")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("累计卸载的class数量")])]),_._v(" "),t("tr",[t("td",[_._v("jvm_classes_loaded_classes")]),_._v(" "),t("td"),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("累计加载的class数量")])])])]),_._v(" "),t("h4",{attrs:{id:"_4-2-16-jvm-编译时间统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-16-jvm-编译时间统计"}},[_._v("#")]),_._v(" 4.2.16. JVM 编译时间统计")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("Metric")]),_._v(" "),t("th",[_._v("Tags")]),_._v(" "),t("th",[_._v("Type")]),_._v(" "),t("th",[_._v("Description")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("jvm_compilation_time_ms")]),_._v(" "),t("td",[_._v('{compiler="HotSpot 64-Bit Tiered Compilers",}')]),_._v(" "),t("td",[_._v("AutoGauge")]),_._v(" "),t("td",[_._v("耗费在编译上的时间")])])])]),_._v(" "),t("h3",{attrs:{id:"_4-3-all-级别监控指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-all-级别监控指标"}},[_._v("#")]),_._v(" 4.3. All 级别监控指标")]),_._v(" "),t("p",[_._v("目前还没有All级别的监控指标，后续会持续添加。")]),_._v(" "),t("h2",{attrs:{id:"_5-怎样获取这些系统监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-怎样获取这些系统监控"}},[_._v("#")]),_._v(" 5. 怎样获取这些系统监控？")]),_._v(" "),t("ul",[t("li",[_._v("监控模块的相关配置均在"),t("code",[_._v("conf/iotdb-{datanode/confignode}.properties")]),_._v("中，所有配置项支持通过"),t("code",[_._v("load configuration")]),_._v("命令热加载。")])]),_._v(" "),t("h3",{attrs:{id:"_5-1-使用-jmx-方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-使用-jmx-方式"}},[_._v("#")]),_._v(" 5.1. 使用 JMX 方式")]),_._v(" "),t("p",[_._v("对于使用 JMX 对外暴露的指标，可以通过 Jconsole 来进行查看。在进入 Jconsole 监控页面后，首先会看到 IoTDB 的各类运行情况的概览。在这里，您可以看到堆内存信息、线程信息、类信息以及服务器的 CPU 使用情况。")]),_._v(" "),t("h4",{attrs:{id:"_5-1-1-获取监控指标数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-1-获取监控指标数据"}},[_._v("#")]),_._v(" 5.1.1. 获取监控指标数据")]),_._v(" "),t("p",[_._v('连接到 JMX 后，您可以通过 "MBeans" 标签找到名为 "org.apache.iotdb.metrics" 的 "MBean"，可以在侧边栏中查看所有监控指标的具体值。')]),_._v(" "),t("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{alt:"metric-jmx",src:"https://user-images.githubusercontent.com/46039728/204018765-6fda9391-ebcf-4c80-98c5-26f34bd74df0.png"}}),_._v(" "),t("h4",{attrs:{id:"_5-1-2-获取其他相关数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-2-获取其他相关数据"}},[_._v("#")]),_._v(" 5.1.2. 获取其他相关数据")]),_._v(" "),t("p",[_._v('连接到 JMX 后，您可以通过 "MBeans" 标签找到名为 "org.apache.iotdb.service" 的 "MBean"，如下图所示，了解服务的基本状态')]),_._v(" "),t("p",[t("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{src:"https://user-images.githubusercontent.com/46039728/149951720-707f1ee8-32ee-4fde-9252-048caebd232e.png"}}),_._v(" "),t("br")]),_._v(" "),t("p",[_._v("为了提高查询性能，IOTDB 对 ChunkMetaData 和 TsFileMetaData 进行了缓存。用户可以使用 MXBean ，展开侧边栏"),t("code",[_._v("org.apache.iotdb.db.service")]),_._v("查看缓存命中率：")]),_._v(" "),t("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{src:"https://user-images.githubusercontent.com/19167280/112426760-73e3da80-8d73-11eb-9a8f-9232d1f2033b.png"}}),_._v(" "),t("h3",{attrs:{id:"_5-2-使用-prometheus-方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-使用-prometheus-方式"}},[_._v("#")]),_._v(" 5.2. 使用 Prometheus 方式")]),_._v(" "),t("h4",{attrs:{id:"_5-2-1-监控指标的-prometheus-映射关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-监控指标的-prometheus-映射关系"}},[_._v("#")]),_._v(" 5.2.1. 监控指标的 Prometheus 映射关系")]),_._v(" "),t("blockquote",[t("p",[_._v("对于 Metric Name 为 name, Tags 为 K1=V1, ..., Kn=Vn 的监控指标有如下映射，其中 value 为具体值")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("监控指标类型")]),_._v(" "),t("th",[_._v("映射关系")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v('name_total{k1="V1", ..., Kn="Vn"} value')])]),_._v(" "),t("tr",[t("td",[_._v("AutoGauge、Gauge")]),_._v(" "),t("td",[_._v('name{k1="V1", ..., Kn="Vn"} value')])]),_._v(" "),t("tr",[t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v('name_max{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name_sum{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name_count{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name{k1="V1", ..., Kn="Vn", quantile="0.0"} value '),t("br"),_._v(' name{k1="V1", ..., Kn="Vn", quantile="0.25"} value '),t("br"),_._v(' name{k1="V1", ..., Kn="Vn", quantile="0.5"} value '),t("br"),_._v(' name{k1="V1", ..., Kn="Vn", quantile="0.75"} value '),t("br"),_._v(' name{k1="V1", ..., Kn="Vn", quantile="1.0"} value')])]),_._v(" "),t("tr",[t("td",[_._v("Rate")]),_._v(" "),t("td",[_._v('name_total{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name_total{k1="V1", ..., Kn="Vn", rate="m1"} value '),t("br"),_._v(' name_total{k1="V1", ..., Kn="Vn", rate="m5"} value  '),t("br"),_._v(' name_total{k1="V1", ..., Kn="Vn", rate="m15"} value '),t("br"),_._v(' name_total{k1="V1", ..., Kn="Vn", rate="mean"} value')])]),_._v(" "),t("tr",[t("td",[_._v("Timer")]),_._v(" "),t("td",[_._v('name_seconds_max{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name_seconds_sum{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name_seconds_count{k1="V1", ..., Kn="Vn"} value '),t("br"),_._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.0"} value '),t("br"),_._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.25"} value '),t("br"),_._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.5"} value '),t("br"),_._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.75"} value '),t("br"),_._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="1.0"} value')])])])]),_._v(" "),t("h4",{attrs:{id:"_5-2-2-修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-2-修改配置文件"}},[_._v("#")]),_._v(" 5.2.2. 修改配置文件")]),_._v(" "),t("ol",[t("li",[_._v("以 DataNode 为例，修改 iotdb-datanode.properties 配置文件如下：")])]),_._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[_._v("dn_metric_reporter_list")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[_._v("PROMETHEUS")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[_._v("dn_metric_level")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[_._v("CORE")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[_._v("dn_metric_prometheus_reporter_port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[_._v("9091")]),_._v("\n")])]),_._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[_._v("1")]),t("br"),t("span",{staticClass:"line-number"},[_._v("2")]),t("br"),t("span",{staticClass:"line-number"},[_._v("3")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[t("p",[_._v("启动 IoTDB DataNode")])]),_._v(" "),t("li",[t("p",[_._v("打开浏览器或者用"),t("code",[_._v("curl")]),_._v(" 访问 "),t("code",[_._v("http://servier_ip:9091/metrics")]),_._v(", 就能得到如下 metric 数据：")])])]),_._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('...\n# HELP file_count\n# TYPE file_count gauge\nfile_count{name="wal",} 0.0\nfile_count{name="unseq",} 0.0\nfile_count{name="seq",} 2.0\n...\n')])]),_._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[_._v("1")]),t("br"),t("span",{staticClass:"line-number"},[_._v("2")]),t("br"),t("span",{staticClass:"line-number"},[_._v("3")]),t("br"),t("span",{staticClass:"line-number"},[_._v("4")]),t("br"),t("span",{staticClass:"line-number"},[_._v("5")]),t("br"),t("span",{staticClass:"line-number"},[_._v("6")]),t("br"),t("span",{staticClass:"line-number"},[_._v("7")]),t("br")])]),t("h4",{attrs:{id:"_5-2-3-prometheus-grafana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-3-prometheus-grafana"}},[_._v("#")]),_._v(" 5.2.3. Prometheus + Grafana")]),_._v(" "),t("p",[_._v("如上所示，IoTDB 对外暴露出标准的 Prometheus 格式的监控指标数据，可以使用 Prometheus 采集并存储监控指标，使用 Grafana 可视化监控指标。")]),_._v(" "),t("p",[_._v("IoTDB、Prometheus、Grafana三者的关系如下图所示:")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/apache/iotdb-bin-resources/main/docs/UserGuide/System%20Tools/Metrics/iotdb_prometheus_grafana.png",alt:"iotdb_prometheus_grafana"}})]),_._v(" "),t("ol",[t("li",[_._v("IoTDB在运行过程中持续收集监控指标数据。")]),_._v(" "),t("li",[_._v("Prometheus以固定的间隔（可配置）从IoTDB的HTTP接口拉取监控指标数据。")]),_._v(" "),t("li",[_._v("Prometheus将拉取到的监控指标数据存储到自己的TSDB中。")]),_._v(" "),t("li",[_._v("Grafana以固定的间隔（可配置）从Prometheus查询监控指标数据并绘图展示。")])]),_._v(" "),t("p",[_._v("从交互流程可以看出，我们需要做一些额外的工作来部署和配置Prometheus和Grafana。")]),_._v(" "),t("p",[_._v("比如，你可以对Prometheus进行如下的配置（部分参数可以自行调整）来从IoTDB获取监控数据")]),_._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("job_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" pull"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("-")]),_._v("metrics\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("honor_labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[_._v("true")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("honor_timestamps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[_._v("true")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("scrape_interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" 15s\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("scrape_timeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" 10s\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("metrics_path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" /metrics\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("scheme")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" http\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("follow_redirects")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[_._v("true")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("static_configs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("-")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[_._v("targets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("-")]),_._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("9091")]),_._v("\n")])]),_._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[_._v("1")]),t("br"),t("span",{staticClass:"line-number"},[_._v("2")]),t("br"),t("span",{staticClass:"line-number"},[_._v("3")]),t("br"),t("span",{staticClass:"line-number"},[_._v("4")]),t("br"),t("span",{staticClass:"line-number"},[_._v("5")]),t("br"),t("span",{staticClass:"line-number"},[_._v("6")]),t("br"),t("span",{staticClass:"line-number"},[_._v("7")]),t("br"),t("span",{staticClass:"line-number"},[_._v("8")]),t("br"),t("span",{staticClass:"line-number"},[_._v("9")]),t("br"),t("span",{staticClass:"line-number"},[_._v("10")]),t("br"),t("span",{staticClass:"line-number"},[_._v("11")]),t("br")])]),t("p",[_._v("更多细节可以参考下面的文档：")]),_._v(" "),t("p",[t("a",{attrs:{href:"https://prometheus.io/docs/prometheus/latest/getting_started/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Prometheus安装使用文档"),t("OutboundLink")],1)]),_._v(" "),t("p",[t("a",{attrs:{href:"https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config",target:"_blank",rel:"noopener noreferrer"}},[_._v("Prometheus从HTTP接口拉取metrics数据的配置说明"),t("OutboundLink")],1)]),_._v(" "),t("p",[t("a",{attrs:{href:"https://grafana.com/docs/grafana/latest/getting-started/getting-started/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Grafana安装使用文档"),t("OutboundLink")],1)]),_._v(" "),t("p",[t("a",{attrs:{href:"https://prometheus.io/docs/visualization/grafana/#grafana-support-for-prometheus",target:"_blank",rel:"noopener noreferrer"}},[_._v("Grafana从Prometheus查询数据并绘图的文档"),t("OutboundLink")],1)]),_._v(" "),t("h4",{attrs:{id:"_5-2-4-apache-iotdb-dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-apache-iotdb-dashboard"}},[_._v("#")]),_._v(" 5.2.4. Apache IoTDB Dashboard")]),_._v(" "),t("p",[_._v("我们提供了Apache IoTDB Dashboard，在Grafana中显示的效果图如下所示：")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/System%20Tools/Metrics/dashboard.png",alt:"Apache IoTDB Dashboard"}})]),_._v(" "),t("h5",{attrs:{id:"_5-2-4-1-如何获取-apache-iotdb-dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-1-如何获取-apache-iotdb-dashboard"}},[_._v("#")]),_._v(" 5.2.4.1. 如何获取 Apache IoTDB Dashboard？")]),_._v(" "),t("ol",[t("li",[_._v("您可以在 grafana-metrics-example 文件夹下获取到对应不同iotdb版本的Dashboard的json文件。")]),_._v(" "),t("li",[_._v("您可以访问"),t("a",{attrs:{href:"https://grafana.com/grafana/dashboards/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Grafana Dashboard官网"),t("OutboundLink")],1),_._v("搜索"),t("code",[_._v("Apache IoTDB Dashboard")]),_._v("并使用")])]),_._v(" "),t("p",[_._v("在创建Grafana时，您可以选择Import刚刚下载的json文件，并为Apache IoTDB Dashboard选择对应目标数据源。")]),_._v(" "),t("h5",{attrs:{id:"_5-2-4-2-apache-iotdb-confignode-dashboard-说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-2-apache-iotdb-confignode-dashboard-说明"}},[_._v("#")]),_._v(" 5.2.4.2. Apache IoTDB ConfigNode Dashboard 说明")]),_._v(" "),t("blockquote",[t("p",[_._v("除特殊说明的监控项以外，以下监控项均保证在Important级别的监控框架中可用。")])]),_._v(" "),t("ul",[t("li",[t("code",[_._v("Overview")]),_._v("：系统概述\n"),t("ul",[t("li",[t("code",[_._v("Registered Node")]),_._v("：注册的ConfigNode/DataNode个数")]),_._v(" "),t("li",[t("code",[_._v("DataNode")]),_._v("：集群DataNode的存活状态，包括Online和Unknown两种。")]),_._v(" "),t("li",[t("code",[_._v("ConfigNode")]),_._v("：集群ConfigNode的存活状态，包括Online和Unknown两种。")]),_._v(" "),t("li",[t("code",[_._v("The Status Of Node")]),_._v("：集群具体节点运行状态，包括Online和Unkown两种。")])])]),_._v(" "),t("li",[t("code",[_._v("Region")]),_._v("：Region概述\n"),t("ul",[t("li",[t("code",[_._v("Region Number")]),_._v("：Region个数，包括总个数，DataRegion 个数和 SchemaRegion 个数。")]),_._v(" "),t("li",[t("code",[_._v("Leadership distribution")]),_._v("：集群 Leader 分布情况，指每个节点上对应 Region 的 Leader 的个数。")]),_._v(" "),t("li",[t("code",[_._v("Total Region in Node")]),_._v("：不同 Node 的 Region 总数量。")]),_._v(" "),t("li",[t("code",[_._v("Region in Node")]),_._v("：不同 Node 的 SchemaRegion/DataRegion 数量。")]),_._v(" "),t("li",[t("code",[_._v("Region in Database")]),_._v("（Normal级别）：不同 Database 的 Region 数量，包括 SchemaRegion、DataRegion。")]),_._v(" "),t("li",[t("code",[_._v("Slot in Database")]),_._v("(Normal级别)：不同 Database 的Slot数量，包括 DataSlot 数量和 SchemaSlot 数量。")])])]),_._v(" "),t("li",[t("code",[_._v("System")]),_._v("：系统\n"),t("ul",[t("li",[t("code",[_._v("CPU Core")]),_._v("：系统 CPU 核数情况。")]),_._v(" "),t("li",[t("code",[_._v("CPU Load")]),_._v("：系统 CPU 负载情况、进度 CPU 负载情况。")]),_._v(" "),t("li",[t("code",[_._v("CPU Time Per Minute")]),_._v("：进程平均每分钟占用系统 CPU 时间，注意：多核会导致该值超过1分钟。")]),_._v(" "),t("li",[t("code",[_._v("System Memory")]),_._v("：系统物理内存大小、系统使用物理内存大小、虚拟机提交的内存大小。")]),_._v(" "),t("li",[t("code",[_._v("System Swap Size")]),_._v("：系统交换区总大小、系统交换区使用大小。")]),_._v(" "),t("li",[t("code",[_._v("Process Memory")]),_._v("：IoTDB 进程最大内存总大小、IoTDB 进程总内存大小、IoTDB 进程使用内存大小。")]),_._v(" "),t("li",[t("code",[_._v("The Number of GC Per Minute")]),_._v("：平均每分钟 GC 次数。")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed Of GC Per Minute")]),_._v("：平均每分钟 GC 耗时。")]),_._v(" "),t("li",[t("code",[_._v("The Number Of Java Thread")]),_._v("：IoTDB 进程的不同状态的线程数。")]),_._v(" "),t("li",[t("code",[_._v("Heap Memory")]),_._v("：IoTDB 进程的堆内存")]),_._v(" "),t("li",[t("code",[_._v("Off Heap Memory")]),_._v("：IoTDB 进程的堆外内存")]),_._v(" "),t("li",[t("code",[_._v("Log Number Per Minute")]),_._v("：IoTDB 进程平均每分钟日志数")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed of Compliation Per Minute")]),_._v("：平均每分钟编译耗时")]),_._v(" "),t("li",[t("code",[_._v("The Number Of Class")]),_._v("：JVM 加载和卸载的类数量")])])])]),_._v(" "),t("h5",{attrs:{id:"_5-2-4-3-apache-iotdb-datanode-dashboard-说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-3-apache-iotdb-datanode-dashboard-说明"}},[_._v("#")]),_._v(" 5.2.4.3. Apache IoTDB DataNode Dashboard 说明")]),_._v(" "),t("blockquote",[t("p",[_._v("除特殊说明的监控项以外，以下监控项均保证在Important级别的监控框架中可用。")])]),_._v(" "),t("ul",[t("li",[t("code",[_._v("Overview")]),_._v("：系统概述\n"),t("ul",[t("li",[t("code",[_._v("The Number Of Entity")]),_._v("：实体数量，包含时间序列等")]),_._v(" "),t("li",[t("code",[_._v("Write Point Per Minute")]),_._v("：每分钟系统平均写入点数")]),_._v(" "),t("li",[t("code",[_._v("Database Used Memory")]),_._v("：每个 Database 使用的内存大小")])])]),_._v(" "),t("li",[t("code",[_._v("Interface")]),_._v("：接口\n"),t("ul",[t("li",[t("code",[_._v("The Time Consumed Of Operation(50%)")]),_._v("：不同客户端操作耗时的中位数")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed Of Operation(75%)")]),_._v("：不同客户端操作耗时的上四分位数")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed Of Operation(100%)")]),_._v("：不同客户端操作耗时的最大值")]),_._v(" "),t("li",[t("code",[_._v("The QPS of Interface")]),_._v("：系统接口每秒钟访问次数")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed Of Interface")]),_._v("：系统接口的平均耗时")]),_._v(" "),t("li",[t("code",[_._v("Cache Hit Rate")]),_._v("：缓存命中率")]),_._v(" "),t("li",[t("code",[_._v("Thrift Connection")]),_._v("：建立的 Thrift 连接个数")]),_._v(" "),t("li",[t("code",[_._v("Thrift Active Thread")]),_._v("：建立的活跃的 Thrift 连接的个数")])])]),_._v(" "),t("li",[t("code",[_._v("Engine")]),_._v("：引擎\n"),t("ul",[t("li",[t("code",[_._v("Task Number")]),_._v("：系统中不同状态的任务个数")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed Of Tasking")]),_._v("：系统中不同状态的任务的耗时")]),_._v(" "),t("li",[t("code",[_._v("Compaction Read And Write Per Minute")]),_._v("：平均每分钟合并读取和写入数据量")]),_._v(" "),t("li",[t("code",[_._v("Compaction R/W Ratio Per Minute")]),_._v("：平均每分钟合并读取和写入数据比")]),_._v(" "),t("li",[t("code",[_._v("Compaction Number Per Minute")]),_._v("：平均每分钟不同类型的合并任务数量")])])]),_._v(" "),t("li",[t("code",[_._v("IoTConsensus")]),_._v("：IoT共识协议\n"),t("ul",[t("li",[t("code",[_._v("IoTConsensus Used Memory")]),_._v("：IoT共识层使用的内存大小")]),_._v(" "),t("li",[t("code",[_._v("IoTConsensus Sync Index")]),_._v("：不同的Region的写入Index和同步Index")]),_._v(" "),t("li",[t("code",[_._v("IoTConsensus Overview")]),_._v("：不同节点的同步总差距、总缓存的请求个数")]),_._v(" "),t("li",[t("code",[_._v("The time consumed of different stages(50%)")]),_._v("：不同阶段耗时的中位数")]),_._v(" "),t("li",[t("code",[_._v("The time consumed of different stages(75%)")]),_._v("：不同阶段耗时的上四分位数")]),_._v(" "),t("li",[t("code",[_._v("The time consumed of different stages(100%)")]),_._v("：不同阶段耗时的最大值")]),_._v(" "),t("li",[t("code",[_._v("IoTConsensus Search Index Rate")]),_._v("：不同region的写入Index的增长速度")]),_._v(" "),t("li",[t("code",[_._v("IoTConsensus Safe Index Rate")]),_._v("：不同region的同步Index的增长速度")]),_._v(" "),t("li",[t("code",[_._v("IoTConsensus LogDispatcher Request Size")]),_._v("：不同的LogDispatcherThread缓存的请求个数")]),_._v(" "),t("li",[t("code",[_._v("Sync Lag")]),_._v("：每个region的同步index差距")]),_._v(" "),t("li",[t("code",[_._v("Min Peer Sync Lag")]),_._v("：每个region的写入index和同步最快的LogDispatcherThread的同步index之间的差距")]),_._v(" "),t("li",[t("code",[_._v("Sync speed diff of Peers")]),_._v("：每个region中同步最快的LogDispatcherThread与同步最慢的LogDispatcherThread之间的同步index差距")])])]),_._v(" "),t("li",[t("code",[_._v("System")]),_._v("：系统\n"),t("ul",[t("li",[t("code",[_._v("CPU Core")]),_._v("：系统 CPU 核数情况。")]),_._v(" "),t("li",[t("code",[_._v("CPU Load")]),_._v("：系统 CPU 负载情况、进度 CPU 负载情况。")]),_._v(" "),t("li",[t("code",[_._v("CPU Time Per Minute")]),_._v("：进程平均每分钟占用系统 CPU 时间，注意：多核会导致该值超过1分钟。")]),_._v(" "),t("li",[t("code",[_._v("System Memory")]),_._v("：系统物理内存大小、系统使用物理内存大小、虚拟机提交的内存大小。")]),_._v(" "),t("li",[t("code",[_._v("System Swap Size")]),_._v("：系统交换区总大小、系统交换区使用大小。")]),_._v(" "),t("li",[t("code",[_._v("Process Memory")]),_._v("：IoTDB 进程最大内存总大小、IoTDB 进程总内存大小、IoTDB 进程使用内存大小。")]),_._v(" "),t("li",[t("code",[_._v("The Size Of File")]),_._v("：IoTDB系统相关的文件大小，包括wal下的文件总大小、seq下的tsfile文件总大小、unseq下的tsfile文件总大小")]),_._v(" "),t("li",[t("code",[_._v("The Number Of File")]),_._v("：IoTDB系统相关的文件个数，包括wal下的文件个数、seq下的tsfile文件个数、unseq下的tsfile文件个数")]),_._v(" "),t("li",[t("code",[_._v("The Space Of Disk")]),_._v("：当前data目录所挂载的磁盘总大小和剩余大小")]),_._v(" "),t("li",[t("code",[_._v("The Number of GC Per Minute")]),_._v("：平均每分钟 GC 次数。")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed Of GC Per Minute")]),_._v("：平均每分钟 GC 耗时。")]),_._v(" "),t("li",[t("code",[_._v("The Number Of Java Thread")]),_._v("：IoTDB 进程的不同状态的线程数。")]),_._v(" "),t("li",[t("code",[_._v("Heap Memory")]),_._v("：IoTDB 进程的堆内存")]),_._v(" "),t("li",[t("code",[_._v("Off Heap Memory")]),_._v("：IoTDB 进程的堆外内存")]),_._v(" "),t("li",[t("code",[_._v("Log Number Per Minute")]),_._v("：IoTDB 进程平均每分钟日志数")]),_._v(" "),t("li",[t("code",[_._v("The Time Consumed of Compliation Per Minute")]),_._v("：平均每分钟编译耗时")]),_._v(" "),t("li",[t("code",[_._v("The Number Of Class")]),_._v("：JVM 加载和卸载的类数量")])])])]),_._v(" "),t("h3",{attrs:{id:"_5-3-使用-iotdb-方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-使用-iotdb-方式"}},[_._v("#")]),_._v(" 5.3. 使用 IoTDB 方式")]),_._v(" "),t("h4",{attrs:{id:"_5-3-1-监控指标的-iotdb-映射关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-监控指标的-iotdb-映射关系"}},[_._v("#")]),_._v(" 5.3.1. 监控指标的 IoTDB 映射关系")]),_._v(" "),t("blockquote",[t("p",[_._v("对于 Metric Name 为 name, Tags 为 K1=V1, ..., Kn=Vn 的监控指标有如下映射，以默认写到 root.__system.metric."),t("code",[_._v("ip:port")]),_._v(" 为例")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("监控指标类型")]),_._v(" "),t("th",[_._v("映射关系")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("Counter")]),_._v(" "),t("td",[_._v("root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".value")])]),_._v(" "),t("tr",[t("td",[_._v("AutoGauge、Gauge")]),_._v(" "),t("td",[_._v("root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".value")])]),_._v(" "),t("tr",[t("td",[_._v("Histogram")]),_._v(" "),t("td",[_._v("root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".count "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".max "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".sum "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p0 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p25 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p50 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p75 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p100")])]),_._v(" "),t("tr",[t("td",[_._v("Rate")]),_._v(" "),t("td",[_._v("root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".count "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".mean "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".m1 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".m5 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".m15")])]),_._v(" "),t("tr",[t("td",[_._v("Timer")]),_._v(" "),t("td",[_._v("root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".count "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".max "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".mean "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".sum "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p0 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p25 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p50 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p75 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".p100   "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".m1 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".m5 "),t("br"),_._v(" root.__system.metric."),t("code",[_._v("ip:port")]),_._v(".name."),t("code",[_._v("K1=V1")]),_._v("..."),t("code",[_._v("Kn=Vn")]),_._v(".m15")])])])]),_._v(" "),t("h4",{attrs:{id:"_5-3-2-获取监控指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-获取监控指标"}},[_._v("#")]),_._v(" 5.3.2. 获取监控指标")]),_._v(" "),t("p",[_._v("根据如上的映射关系，可以构成相关的 IoTDB 查询语句获取监控指标")])])}),[],!1,null,null,null);t.default=a.exports}}]);