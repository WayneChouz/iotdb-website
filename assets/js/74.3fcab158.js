(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{687:function(e,s,t){"use strict";t.r(s);var a=t(82),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"prerequisite"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisite"}},[e._v("#")]),e._v(" Prerequisite")]),e._v(" "),t("p",[e._v("Note: Please install MinGW or WSL or git bash if you are using Windows.")]),e._v(" "),t("h2",{attrs:{id:"example-of-distributed-configurations-for-1-node-and-1-replica"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-of-distributed-configurations-for-1-node-and-1-replica"}},[e._v("#")]),e._v(" Example of distributed configurations for 1 node and 1 replica")]),e._v(" "),t("h3",{attrs:{id:"compile-from-source-code"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#compile-from-source-code"}},[e._v("#")]),e._v(" Compile from source code:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("mvn clean package -DskipTests\nchmod -R 777 ./cluster/target/\nnohup ./cluster/target/iotdb-cluster-0.13.0-SNAPSHOT/sbin/start-node.sh >/dev/null 2>&1 &\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("h3",{attrs:{id:"use-the-official-website-release-version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#use-the-official-website-release-version"}},[e._v("#")]),e._v(" Use the official website release version:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("curl -O https://downloads.apache.org/iotdb/0.12.1/apache-iotdb-0.12.1-cluster-bin.zip\nunzip apache-iotdb-0.12.1-cluster-bin.zip\ncd apache-iotdb-0.12.1-cluster-bin\nsed -i -e 's/^seed_nodes=127.0.0.1:9003,127.0.0.1:9005,127.0.0.1:9007$/seed_nodes=127.0.0.1:9003/g' conf/iotdb-cluster.properties\nsed -i -e 's/^default_replica_num=3$/default_replica_num=1/g' conf/iotdb-cluster.properties\nnohup ./sbin/start-node.sh >/dev/null 2>&1 &\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("h2",{attrs:{id:"example-of-distributed-configurations-for-3-nodes-and-1-replica-on-a-single-machine"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-of-distributed-configurations-for-3-nodes-and-1-replica-on-a-single-machine"}},[e._v("#")]),e._v(" Example of distributed configurations for 3 nodes and 1 replica on a single machine")]),e._v(" "),t("h3",{attrs:{id:"configurations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configurations"}},[e._v("#")]),e._v(" Configurations")]),e._v(" "),t("p",[e._v("You can start multiple instances on a single machine by modifying the configurations yourself to handling port and file directory conflicts.")]),e._v(" "),t("p",[t("strong",[e._v("Node1")]),e._v(":"),t("strong",[e._v("(default)")])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("iotdb-cluster.properties")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("seed_nodes = 127.0.0.1:9003,127.0.0.1:9005,127.0.0.1:9007\ndefault_replica_num = 1\ninternal_meta_port = 9003\ninternal_data_port = 40010\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[t("em",[t("strong",[e._v("iotdb-engine.properties")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rpc_port=6667\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("strong",[e._v("Node2")]),e._v(":")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("iotdb-cluster.properties")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("seed_nodes = 127.0.0.1:9003,127.0.0.1:9005,127.0.0.1:9007\ndefault_replica_num = 1\ninternal_meta_port = 9005\ninternal_data_port = 40012\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[t("em",[t("strong",[e._v("iotdb-engine.properties")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rpc_port=6669\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("strong",[e._v("Node3")]),e._v(":")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("iotdb-cluster.properties")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("seed_nodes = 127.0.0.1:9003,127.0.0.1:9005,127.0.0.1:9007\ndefault_replica_num = 1\ninternal_meta_port = 9007\ninternal_data_port = 40014\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[t("em",[t("strong",[e._v("iotdb-engine.properties")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("rpc_port=6671\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"compile-from-source-code-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#compile-from-source-code-2"}},[e._v("#")]),e._v(" Compile from source code:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("mvn clean package -DskipTests\nchmod -R 777 ./cluster/target/\nnohup ./cluster/target/iotdb-cluster-0.13.0-SNAPSHOT/sbin/start-node.sh ./cluster/target/test-classes/node1conf/ >/dev/null 2>&1 &\nnohup ./cluster/target/iotdb-cluster-0.13.0-SNAPSHOT/sbin/start-node.sh ./cluster/target/test-classes/node2conf/ >/dev/null 2>&1 &\nnohup ./cluster/target/iotdb-cluster-0.13.0-SNAPSHOT/sbin/start-node.sh ./cluster/target/test-classes/node3conf/ >/dev/null 2>&1 &\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("h3",{attrs:{id:"use-the-official-website-release-version-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#use-the-official-website-release-version-2"}},[e._v("#")]),e._v(" Use the official website release version:")]),e._v(" "),t("p",[e._v("Download the release version:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("curl -O https://downloads.apache.org/iotdb/0.12.1/apache-iotdb-0.12.1-cluster-bin.zip\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Unzip the package:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("unzip apache-iotdb-0.12.1-cluster-bin.zip\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Enter IoTDB cluster root directory:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd apache-iotdb-0.12.1-cluster-bin\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Set default_replica_num = 1:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sed -i -e 's/^default_replica_num=3$/default_replica_num=1/g' conf/iotdb-cluster.properties\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Create conf_dir for node2 and node3:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cp -r conf node2_conf\ncp -r conf node3_conf\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("Handle port and file directory conflicts:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sed -i -e 's/^internal_meta_port=9003$/internal_meta_port=9005/g' -e 's/^internal_data_port=40010$/internal_data_port=40012/g' node2_conf/iotdb-cluster.properties\nsed -i -e 's/^internal_meta_port=9003$/internal_meta_port=9007/g' -e 's/^internal_data_port=40010$/internal_data_port=40014/g' node3_conf/iotdb-cluster.properties\nsed -i -e 's/^rpc_port=6667$/rpc_port=6669/g' -e node2_conf/iotdb-engine.properties\nsed -i -e 's/^rpc_port=6667$/rpc_port=6671/g' -e node3_conf/iotdb-engine.properties\nsed -i -e 's/^# data_dirs=data\\/data$/data_dirs=node2\\/data/g' -e 's/^# wal_dir=data\\/wal$/wal_dir=node2\\/wal/g' -e 's/^# tracing_dir=data\\/tracing$/tracing_dir=node2\\/tracing/g' -e 's/^# system_dir=data\\/system$/system_dir=node2\\/system/g' -e 's/^# udf_root_dir=ext\\/udf$/udf_root_dir=node2\\/ext\\/udf/g' -e 's/^# index_root_dir=data\\/index$/index_root_dir=node2\\/index/g' node2_conf/iotdb-engine.properties\nsed -i -e 's/^# data_dirs=data\\/data$/data_dirs=node3\\/data/g' -e 's/^# wal_dir=data\\/wal$/wal_dir=node3\\/wal/g' -e 's/^# tracing_dir=data\\/tracing$/tracing_dir=node3\\/tracing/g' -e 's/^# system_dir=data\\/system$/system_dir=node3\\/system/g' -e 's/^# udf_root_dir=ext\\/udf$/udf_root_dir=node3\\/ext\\/udf/g' -e 's/^# index_root_dir=data\\/index$/index_root_dir=node3\\/index/g' node3_conf/iotdb-engine.properties\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[t("strong",[e._v('You can modify the configuration items by yourself instead of using "sed" command')])]),e._v(" "),t("p",[e._v("Start the three nodes with their configurations:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("nohup ./sbin/start-node.sh >/dev/null 2>&1 &\nnohup ./sbin/start-node.sh ./node2_conf/ >/dev/null 2>&1 &\nnohup ./sbin/start-node.sh ./node3_conf/ >/dev/null 2>&1 &\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("h2",{attrs:{id:"example-of-distributed-configurations-for-3-nodes-and-3-replicas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example-of-distributed-configurations-for-3-nodes-and-3-replicas"}},[e._v("#")]),e._v(" Example of distributed configurations for 3 nodes and 3 replicas")]),e._v(" "),t("p",[e._v("Suppose we need to deploy the distributed IoTDB on three physical nodes, A, B, and C, whose public network IP is "),t("em",[e._v("A_public_IP")]),e._v(", "),t("em",[e._v("B_public_IP")]),e._v(", and "),t("em",[e._v("C_public_IP")]),e._v(", and private network IP is "),t("em",[e._v("A_private_IP")]),e._v(", "),t("em",[e._v("B_private_IP")]),e._v(", and "),t("em",[e._v("C_private_IP")]),e._v(".\nNote: If there is no public network IP or private network IP, both can be set to the same, just need to ensure that the client can access the server.")]),e._v(" "),t("h3",{attrs:{id:"configurations-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configurations-2"}},[e._v("#")]),e._v(" Configurations")]),e._v(" "),t("p",[t("strong",[e._v("Each Node:")])]),e._v(" "),t("p",[t("em",[t("strong",[e._v("iotdb-cluster.properties")])])]),e._v(" "),t("p",[e._v("seed_nodes = "),t("em",[e._v("A_private_Ip")]),e._v(":9003,"),t("em",[e._v("B_private_Ip")]),e._v(":9003,"),t("em",[e._v("C_private_Ip")]),e._v(":9003")]),e._v(" "),t("p",[e._v("default_replica_num = 3")]),e._v(" "),t("p",[e._v("internal_ip = "),t("em",[e._v("A_private_Ip")]),e._v(" (or "),t("em",[e._v("B_private_Ip")]),e._v(", "),t("em",[e._v("C_private_Ip")]),e._v(")")]),e._v(" "),t("p",[t("em",[t("strong",[e._v("iotdb-engine.properties")])])]),e._v(" "),t("p",[e._v("rpc_address = "),t("em",[e._v("A_public_Ip")]),e._v(" (or "),t("em",[e._v("B_public_Ip")]),e._v(", "),t("em",[e._v("C_public_Ip")]),e._v(")")]),e._v(" "),t("h3",{attrs:{id:"start-iotdb-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#start-iotdb-cluster"}},[e._v("#")]),e._v(" Start IoTDB cluster")]),e._v(" "),t("p",[e._v("The operation steps are as follows:")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Use 'mvn clean package -pl cluster -am -DskipTests' to compile the distributed module or directly go into the "),t("a",{attrs:{href:"https://iotdb.apache.org/Download/",target:"_blank",rel:"noopener noreferrer"}},[e._v("website"),t("OutboundLink")],1),e._v(" to download the latest version.")])]),e._v(" "),t("li",[t("p",[e._v("Make sure ports 6567, 6667, 9003, 9004, 40010, 40011 and 31999 are open on all three nodes.")])]),e._v(" "),t("li",[t("p",[e._v("Send the package to all servers.")])]),e._v(" "),t("li",[t("p",[e._v("Modify the configuration items.")])]),e._v(" "),t("li",[t("p",[e._v("Run sh sbin/start-node.sh on each of the three nodes (or run in the background).")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);