(window.webpackJsonp=window.webpackJsonp||[]).push([[1138],{1540:function(t,_,e){"use strict";e.r(_);var v=e(29),a=Object(v.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("p",[t._v("在 IoTDB 的运行过程中，我们希望对 IoTDB 的状态进行观测，以便于排查系统问题或者及时发现系统潜在的风险，能够"),_("strong",[t._v("反映系统运行状态的一系列指标")]),t._v("就是系统监控指标。")]),t._v(" "),_("h1",{attrs:{id:"_1-什么场景下会使用到监控"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么场景下会使用到监控"}},[t._v("#")]),t._v(" 1. 什么场景下会使用到监控?")]),t._v(" "),_("p",[t._v("那么什么时候会用到监控框架呢？下面列举一些常见的场景。")]),t._v(" "),_("ol",[_("li",[_("p",[t._v("系统变慢了")]),t._v(" "),_("p",[t._v("系统变慢几乎是最常见也最头疼的问题，这时候我们需要尽可能多的信息来帮助我们找到系统变慢的原因，比如：")]),t._v(" "),_("ul",[_("li",[t._v("JVM信息：是不是有FGC？GC耗时多少？GC后内存有没有恢复？是不是有大量的线程？")]),t._v(" "),_("li",[t._v("系统信息：CPU使用率是不是太高了？磁盘IO是不是很频繁？")]),t._v(" "),_("li",[t._v("连接数：当前连接是不是太多？")]),t._v(" "),_("li",[t._v("接口：当前TPS是多少？各个接口耗时有没有变化？")]),t._v(" "),_("li",[t._v("线程池：系统中各种任务是否有积压？")]),t._v(" "),_("li",[t._v("缓存命中率")])])]),t._v(" "),_("li",[_("p",[t._v("磁盘快满了")]),t._v(" "),_("p",[t._v("这时候我们迫切想知道最近一段时间数据文件的增长情况，看看是不是某种文件有突增。")])]),t._v(" "),_("li",[_("p",[t._v("系统运行是否正常")]),t._v(" "),_("p",[t._v("此时我们可能需要通过错误日志的数量、集群节点的状态等指标来判断系统是否在正常运行。")])])]),t._v(" "),_("h1",{attrs:{id:"_2-什么人需要使用监控"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-什么人需要使用监控"}},[t._v("#")]),t._v(" 2. 什么人需要使用监控?")]),t._v(" "),_("p",[t._v("所有关注系统状态的人员都可以使用，包括但不限于研发、测试、运维、DBA等等")]),t._v(" "),_("h1",{attrs:{id:"_3-什么是监控指标"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-什么是监控指标"}},[t._v("#")]),t._v(" 3. 什么是监控指标？")]),t._v(" "),_("h2",{attrs:{id:"_3-1-监控指标名词解释"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-监控指标名词解释"}},[t._v("#")]),t._v(" 3.1. 监控指标名词解释")]),t._v(" "),_("p",[t._v("在 IoTDB 的监控模块，每个监控指标被 "),_("code",[t._v("Metric Name")]),t._v(" 和 "),_("code",[t._v("Tags")]),t._v(" 唯一标识。")]),t._v(" "),_("ul",[_("li",[_("code",[t._v("Metric Name")]),t._v("："),_("strong",[t._v("指标类型名称")]),t._v("，比如logback_events表示日志事件。")]),t._v(" "),_("li",[_("code",[t._v("Tags")]),t._v("："),_("strong",[t._v("指标分类")]),t._v("，形式为Key-Value对，每个指标下面可以有0到多个分类，常见的Key-Value对：\n"),_("ul",[_("li",[_("code",[t._v("name = xxx")]),t._v("：被监控项的名称，比如对"),_("code",[t._v("entry_seconds_count")]),t._v("这个监控项，name 的含义是被监控的接口名称。")]),t._v(" "),_("li",[_("code",[t._v("status = xxx")]),t._v("：被监控项的状态细分，比如监控 Task 的监控项可以通过该参数，将运行的 Task 和停止的 Task 分开。")]),t._v(" "),_("li",[_("code",[t._v("user = xxx")]),t._v("：被监控项和某个特定用户相关，比如统计root用户的写入总次数。")]),t._v(" "),_("li",[t._v("根据具体情况自定义：比如logback_events_total下有一个"),_("code",[t._v("level")]),t._v("的分类，用来表示特定级别下的日志数量")])])]),t._v(" "),_("li",[_("code",[t._v("Metric Level")]),t._v("："),_("strong",[t._v("指标管理级别")]),t._v("，默认启动级别为"),_("code",[t._v("Core")]),t._v("级别，建议启动级别为"),_("code",[t._v("Important级别")]),t._v("，审核严格程度"),_("code",[t._v("Core > Important > Normal > All")]),t._v(" "),_("ul",[_("li",[_("code",[t._v("Core")]),t._v("：系统的核心指标，供"),_("strong",[t._v("系统内核和运维人员")]),t._v("使用，关乎系统的"),_("strong",[t._v("性能、稳定性、安全性")]),t._v("，比如实例的状况，系统的负载等。")]),t._v(" "),_("li",[_("code",[t._v("Important")]),t._v("：模块的重要指标，供"),_("strong",[t._v("运维和测试人员")]),t._v("使用，直接关乎"),_("strong",[t._v("每个模块的运行状态")]),t._v("，比如合并文件个数、执行情况等。")]),t._v(" "),_("li",[_("code",[t._v("Normal")]),t._v("：模块的一般指标，供"),_("strong",[t._v("开发人员")]),t._v("使用，方便在出现问题时"),_("strong",[t._v("定位模块")]),t._v("，比如合并中的特定关键操作情况。")]),t._v(" "),_("li",[_("code",[t._v("All")]),t._v("：模块的全部指标，供"),_("strong",[t._v("模块开发人员")]),t._v("使用，往往在复现问题的时候使用，从而快速解决问题。")])])])]),t._v(" "),_("h2",{attrs:{id:"_3-2-监控指标对外获取数据格式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-监控指标对外获取数据格式"}},[t._v("#")]),t._v(" 3.2. 监控指标对外获取数据格式")]),t._v(" "),_("ul",[_("li",[t._v("IoTDB 对外提供 JMX、 Prometheus 和 IoTDB 格式的监控指标：\n"),_("ul",[_("li",[t._v("对于 JMX ，可以通过"),_("code",[t._v("org.apache.iotdb.metrics")]),t._v("获取系统监控指标指标。")]),t._v(" "),_("li",[t._v("对于 Prometheus ，可以通过对外暴露的端口获取监控指标的值")]),t._v(" "),_("li",[t._v("对于 IoTDB 方式对外暴露：可以通过执行 IoTDB 的查询来获取监控指标")])])])]),t._v(" "),_("h1",{attrs:{id:"_4-监控指标有哪些"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-监控指标有哪些"}},[t._v("#")]),t._v(" 4. 监控指标有哪些？")]),t._v(" "),_("p",[t._v("目前，IoTDB 对外提供一些主要模块的监控指标，并且随着新功能的开发以及系统优化或者重构，监控指标也会同步添加和更新。如果想自己在 IoTDB 中添加更多系统监控指标埋点，可以参考"),_("a",{attrs:{href:"https://github.com/apache/iotdb/tree/master/metrics",target:"_blank",rel:"noopener noreferrer"}},[t._v("IoTDB Metrics Framework"),_("OutboundLink")],1),t._v("使用说明。")]),t._v(" "),_("h2",{attrs:{id:"_4-1-core-级别监控指标"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-core-级别监控指标"}},[t._v("#")]),t._v(" 4.1. Core 级别监控指标")]),t._v(" "),_("p",[t._v("Core 级别的监控指标在系统运行中默认开启，每一个 Core 级别的监控指标的添加都需要经过谨慎的评估，目前 Core 级别的监控指标如下所述：")]),t._v(" "),_("h3",{attrs:{id:"_4-1-1-集群运行状态"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-集群运行状态"}},[t._v("#")]),t._v(" 4.1.1. 集群运行状态")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("config_node")]),t._v(" "),_("td",[t._v('name="total",status="Registered/Online/Unknown"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("已注册/在线/离线 confignode 的节点数量")])]),t._v(" "),_("tr",[_("td",[t._v("data_node")]),t._v(" "),_("td",[t._v('name="total",status="Registered/Online/Unknown"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("已注册/在线/离线 datanode 的节点数量")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-1-2-iotdb-进程运行状态"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-iotdb-进程运行状态"}},[t._v("#")]),t._v(" 4.1.2. IoTDB 进程运行状态")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("process_cpu_load")]),t._v(" "),_("td",[t._v('name="process"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程的 CPU 占用率，单位为%")])]),t._v(" "),_("tr",[_("td",[t._v("process_cpu_time")]),t._v(" "),_("td",[t._v('name="process"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程占用的 CPU 时间，单位为ns")])]),t._v(" "),_("tr",[_("td",[t._v("process_max_mem")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程最大可用内存")])]),t._v(" "),_("tr",[_("td",[t._v("process_total_mem")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程当前已申请内存")])]),t._v(" "),_("tr",[_("td",[t._v("process_free_mem")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程当前剩余可用内存")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-1-3-系统运行状态"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-系统运行状态"}},[t._v("#")]),t._v(" 4.1.3. 系统运行状态")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("sys_cpu_load")]),t._v(" "),_("td",[t._v('name="system"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统的 CPU 占用率，单位为%")])]),t._v(" "),_("tr",[_("td",[t._v("sys_cpu_cores")]),t._v(" "),_("td",[t._v('name="system"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("系统的可用处理器数")])]),t._v(" "),_("tr",[_("td",[t._v("sys_total_physical_memory_size")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("系统的最大物理内存")])]),t._v(" "),_("tr",[_("td",[t._v("sys_free_physical_memory_size")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统的剩余可用内存")])]),t._v(" "),_("tr",[_("td",[t._v("sys_total_swap_space_size")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统的交换区最大空间")])]),t._v(" "),_("tr",[_("td",[t._v("sys_free_swap_space_size")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统的交换区剩余可用空间")])]),t._v(" "),_("tr",[_("td",[t._v("sys_committed_vm_size")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统保证可用于正在运行的进程的虚拟内存量")])]),t._v(" "),_("tr",[_("td",[t._v("sys_disk_total_space")]),t._v(" "),_("td",[t._v('name="disk"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统磁盘总大小")])]),t._v(" "),_("tr",[_("td",[t._v("sys_disk_free_space")]),t._v(" "),_("td",[t._v('name="disk"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统磁盘可用大小")])])])]),t._v(" "),_("h2",{attrs:{id:"_4-2-important-级别监控指标"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-important-级别监控指标"}},[t._v("#")]),t._v(" 4.2. Important 级别监控指标")]),t._v(" "),_("p",[t._v("目前 Important 级别的监控指标如下所述：")]),t._v(" "),_("h3",{attrs:{id:"_4-2-1-集群运行状态"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-集群运行状态"}},[t._v("#")]),t._v(" 4.2.1. 集群运行状态")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("cluster_node_leader_count")]),t._v(" "),_("td",[t._v('name="'+t._s(t.ip)+":"+t._s(t.port)+'"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("节点上共识组Leader的数量")])]),t._v(" "),_("tr",[_("td",[t._v("cluster_node_status")]),t._v(" "),_("td",[t._v('name="'+t._s(t.ip)+":"+t._s(t.port)+'",type="ConfigNode/DataNode"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("节点的状态，0=Unkonwn 1=online")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-2-节点统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-节点统计"}},[t._v("#")]),t._v(" 4.2.2. 节点统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("quantity")]),t._v(" "),_("td",[t._v('name="database"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统数据库数量")])]),t._v(" "),_("tr",[_("td",[t._v("quantity")]),t._v(" "),_("td",[t._v('name="timeSeries"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("系统时间序列数量")])]),t._v(" "),_("tr",[_("td",[t._v("quantity")]),t._v(" "),_("td",[t._v('name="pointsIn"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("系统累计写入点数")])]),t._v(" "),_("tr",[_("td",[t._v("region")]),t._v(" "),_("td",[t._v('name="total",type="SchemaRegion"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("分区表中 SchemaRegion 总数量")])]),t._v(" "),_("tr",[_("td",[t._v("region")]),t._v(" "),_("td",[t._v('name="total",type="DataRegion"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("分区表中 DataRegion 总数量")])]),t._v(" "),_("tr",[_("td",[t._v("region")]),t._v(" "),_("td",[t._v('name="'+t._s(t.ip)+":"+t._s(t.port)+'",type="SchemaRegion"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("分区表中对应节点上 DataRegion 总数量")])]),t._v(" "),_("tr",[_("td",[t._v("region")]),t._v(" "),_("td",[t._v('name="'+t._s(t.ip)+":"+t._s(t.port)+'",type="DataRegion"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("分区表中对应节点上 DataRegion 总数量")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-3-iot共识协议统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-iot共识协议统计"}},[t._v("#")]),t._v(" 4.2.3. IoT共识协议统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("iot_consensus")]),t._v(" "),_("td",[t._v('name="logDispatcher-'+t._s(t.IP)+":"+t._s(t.Port)+'", region="'+t._s(t.region)+'", type="currentSyncIndex"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("副本组同步线程的当前同步进度")])]),t._v(" "),_("tr",[_("td",[t._v("iot_consensus")]),t._v(" "),_("td",[t._v('name="logDispatcher-'+t._s(t.IP)+":"+t._s(t.Port)+'", region="'+t._s(t.region)+'", type="cachedRequestInMemoryQueue"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("副本组同步线程缓存队列请求总大小")])]),t._v(" "),_("tr",[_("td",[t._v("iot_consensus")]),t._v(" "),_("td",[t._v('name="IoTConsensusServerImpl", region="'+t._s(t.region)+'", type="searchIndex"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("副本组主流程写入进度")])]),t._v(" "),_("tr",[_("td",[t._v("iot_consensus")]),t._v(" "),_("td",[t._v('name="IoTConsensusServerImpl", region="'+t._s(t.region)+'", type="safeIndex"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("副本组同步进度")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="getStateMachineLock"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("主流程获取状态机锁耗时")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="checkingBeforeWrite"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("主流程写入状态机检查耗时")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="writeStateMachine"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("主流程写入状态机耗时")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="offerRequestToQueue"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("主流程尝试添加队列耗时")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="consensusWrite"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("主流程全写入耗时")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="constructBatch"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("同步线程构造 Batch 耗时")])]),t._v(" "),_("tr",[_("td",[t._v("stage")]),t._v(" "),_("td",[t._v('name="iot_consensus", region="'+t._s(t.region)+'", type="syncLogTimePerRequest"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("异步回调流程同步日志耗时")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-4-缓存统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-缓存统计"}},[t._v("#")]),t._v(" 4.2.4. 缓存统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("cache_hit")]),t._v(" "),_("td",[t._v('name="chunk"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("ChunkCache的命中率，单位为%")])]),t._v(" "),_("tr",[_("td",[t._v("cache_hit")]),t._v(" "),_("td",[t._v('name="schema"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("SchemaCache的命中率，单位为%")])]),t._v(" "),_("tr",[_("td",[t._v("cache_hit")]),t._v(" "),_("td",[t._v('name="timeSeriesMeta"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("TimeseriesMetadataCache的命中率，单位为%")])]),t._v(" "),_("tr",[_("td",[t._v("cache_hit")]),t._v(" "),_("td",[t._v('name="bloomFilter"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("TimeseriesMetadataCache中的bloomFilter的拦截率，单位为%")])]),t._v(" "),_("tr",[_("td",[t._v("cache")]),t._v(" "),_("td",[t._v('name="Database", type="hit"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("Database Cache 的命中次数")])]),t._v(" "),_("tr",[_("td",[t._v("cache")]),t._v(" "),_("td",[t._v('name="Database", type="all"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("Database Cache 的访问次数")])]),t._v(" "),_("tr",[_("td",[t._v("cache")]),t._v(" "),_("td",[t._v('name="SchemaPartition", type="hit"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("SchemaPartition Cache 的命中次数")])]),t._v(" "),_("tr",[_("td",[t._v("cache")]),t._v(" "),_("td",[t._v('name="SchemaPartition", type="all"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("SchemaPartition Cache 的访问次数")])]),t._v(" "),_("tr",[_("td",[t._v("cache")]),t._v(" "),_("td",[t._v('name="DataPartition", type="hit"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("DataPartition Cache 的命中次数")])]),t._v(" "),_("tr",[_("td",[t._v("cache")]),t._v(" "),_("td",[t._v('name="DataPartition", type="all"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("DataPartition Cache 的访问次数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-5-接口层统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-接口层统计"}},[t._v("#")]),t._v(" 4.2.5. 接口层统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("operation")]),t._v(" "),_("td",[t._v('name = "'+t._s(t.name)+'"')]),t._v(" "),_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("客户端执行的操作的耗时情况")])]),t._v(" "),_("tr",[_("td",[t._v("entry")]),t._v(" "),_("td",[t._v('name="'+t._s(t.interface)+'"')]),t._v(" "),_("td",[t._v("Timer")]),t._v(" "),_("td",[t._v("Client 建立的 Thrift 的耗时情况")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_connections")]),t._v(" "),_("td",[t._v('name="ConfigNodeRPC"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("ConfigNode 的内部 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_connections")]),t._v(" "),_("td",[t._v('name="Internal"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("DataNode 的内部 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_connections")]),t._v(" "),_("td",[t._v('name="MPPDataExchange"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("MPP 框架的内部 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_connections")]),t._v(" "),_("td",[t._v('name="RPC"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("Client 建立的 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_active_threads")]),t._v(" "),_("td",[t._v('name="ConfigNodeRPC-Service"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("ConfigNode 的内部活跃 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_active_threads")]),t._v(" "),_("td",[t._v('name="DataNodeInternalRPC-Service"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("DataNode 的内部活跃 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_active_threads")]),t._v(" "),_("td",[t._v('name="MPPDataExchangeRPC-Service"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("MPP 框架的内部活跃 Thrift 连接数")])]),t._v(" "),_("tr",[_("td",[t._v("thrift_active_threads")]),t._v(" "),_("td",[t._v('name="ClientRPC-Service"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("Client 建立的活跃 Thrift 连接数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-6-内存统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-6-内存统计"}},[t._v("#")]),t._v(" 4.2.6. 内存统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("mem")]),t._v(" "),_("td",[t._v('name="database_'+t._s(t.name)+'"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("DataNode内对应DataRegion的内存占用，单位为byte")])]),t._v(" "),_("tr",[_("td",[t._v("mem")]),t._v(" "),_("td",[t._v('name="chunkMetaData_'+t._s(t.name)+'"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("写入TsFile时的ChunkMetaData的内存占用，单位为byte")])]),t._v(" "),_("tr",[_("td",[t._v("mem")]),t._v(" "),_("td",[t._v('name="IoTConsensus"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoT共识协议的内存占用，单位为byte")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-7-任务统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-7-任务统计"}},[t._v("#")]),t._v(" 4.2.7. 任务统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("queue")]),t._v(" "),_("td",[t._v('name="compaction_inner", status="running/waiting"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("空间内合并任务数")])]),t._v(" "),_("tr",[_("td",[t._v("queue")]),t._v(" "),_("td",[t._v('name="compaction_cross", status="running/waiting"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("跨空间合并任务数")])]),t._v(" "),_("tr",[_("td",[t._v("cost_task")]),t._v(" "),_("td",[t._v('name="inner_compaction/cross_compaction/flush"')]),t._v(" "),_("td",[t._v("Gauge")]),t._v(" "),_("td",[t._v("任务耗时情况")])]),t._v(" "),_("tr",[_("td",[t._v("queue")]),t._v(" "),_("td",[t._v('name="flush",status="running/waiting"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("刷盘任务数")])]),t._v(" "),_("tr",[_("td",[t._v("queue")]),t._v(" "),_("td",[t._v('name="Sub_RawQuery",status="running/waiting"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("Sub_RawQuery任务数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-8-合并统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-8-合并统计"}},[t._v("#")]),t._v(" 4.2.8. 合并统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("data_written")]),t._v(" "),_("td",[t._v('name="compaction", type="aligned/not-aligned/total"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("合并时写入量")])]),t._v(" "),_("tr",[_("td",[t._v("data_read")]),t._v(" "),_("td",[t._v('name="compaction"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("合并时的读取量")])]),t._v(" "),_("tr",[_("td",[t._v("compaction_task_count")]),t._v(" "),_("td",[t._v('name = "inner_compaction", type="sequence"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("顺序空间内合并次数")])]),t._v(" "),_("tr",[_("td",[t._v("compaction_task_count")]),t._v(" "),_("td",[t._v('name = "inner_compaction", type="unsequence"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("乱序空间内合并次数")])]),t._v(" "),_("tr",[_("td",[t._v("compaction_task_count")]),t._v(" "),_("td",[t._v('name = "cross_compaction", type="cross"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("跨空间合并次数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-9-文件统计信息"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-9-文件统计信息"}},[t._v("#")]),t._v(" 4.2.9. 文件统计信息")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("file_size")]),t._v(" "),_("td",[t._v('name="wal"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("写前日志总大小，单位为byte")])]),t._v(" "),_("tr",[_("td",[t._v("file_size")]),t._v(" "),_("td",[t._v('name="seq"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("顺序TsFile总大小，单位为byte")])]),t._v(" "),_("tr",[_("td",[t._v("file_size")]),t._v(" "),_("td",[t._v('name="unseq"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("乱序TsFile总大小，单位为byte")])]),t._v(" "),_("tr",[_("td",[t._v("file_count")]),t._v(" "),_("td",[t._v('name="wal"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("写前日志文件个数")])]),t._v(" "),_("tr",[_("td",[t._v("file_count")]),t._v(" "),_("td",[t._v('name="seq"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("顺序TsFile文件个数")])]),t._v(" "),_("tr",[_("td",[t._v("file_count")]),t._v(" "),_("td",[t._v('name="unseq"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("乱序TsFile文件个数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-10-iotdb-进程统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-10-iotdb-进程统计"}},[t._v("#")]),t._v(" 4.2.10. IoTDB 进程统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("process_used_mem")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程当前使用内存")])]),t._v(" "),_("tr",[_("td",[t._v("process_mem_ratio")]),t._v(" "),_("td",[t._v('name="memory"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程的内存占用比例")])]),t._v(" "),_("tr",[_("td",[t._v("process_threads_count")]),t._v(" "),_("td",[t._v('name="process"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程当前线程数")])]),t._v(" "),_("tr",[_("td",[t._v("process_status")]),t._v(" "),_("td",[t._v('name="process"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("IoTDB 进程存活状态，1为存活，0为终止")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-11-iotdb-日志统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-11-iotdb-日志统计"}},[t._v("#")]),t._v(" 4.2.11. IoTDB 日志统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("logback_events")]),t._v(" "),_("td",[t._v('level="trace/debug/info/warn/error"')]),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("不同类型的日志个数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-12-jvm-线程统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-12-jvm-线程统计"}},[t._v("#")]),t._v(" 4.2.12. JVM 线程统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("jvm_threads_live_threads")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("当前线程数")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_threads_daemon_threads")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("当前 Daemon 线程数")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_threads_peak_threads")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("峰值线程数")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_threads_states_threads")]),t._v(" "),_("td",[t._v('state="runnable/blocked/waiting/timed-waiting/new/terminated"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("当前处于各种状态的线程数")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-13-jvm-gc-统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-13-jvm-gc-统计"}},[t._v("#")]),t._v(" 4.2.13. JVM GC 统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("jvm_gc_pause")]),t._v(" "),_("td",[t._v('action="end of major GC/end of minor GC",cause="xxxx"')]),t._v(" "),_("td",[t._v("Timer")]),t._v(" "),_("td",[t._v("不同原因的Young GC/Full GC的次数与耗时")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("jvm_gc_concurrent_phase_time")]),t._v(" "),_("td",[t._v('action="'+t._s(t.action)+'",cause="'+t._s(t.cause)+'"')]),t._v(" "),_("td",[t._v("Timer")]),t._v(" "),_("td",[t._v("不同原因的Young GC/Full GC的次数与耗时")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("jvm_gc_max_data_size_bytes")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("老年代内存的历史最大值")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_gc_live_data_size_bytes")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("老年代内存的使用值")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_gc_memory_promoted_bytes")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("老年代内存正向增长累计值")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_gc_memory_allocated_bytes")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("GC分配内存正向增长累计值")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-14-jvm-内存统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-14-jvm-内存统计"}},[t._v("#")]),t._v(" 4.2.14. JVM 内存统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("jvm_buffer_memory_used_bytes")]),t._v(" "),_("td",[t._v('id="direct/mapped"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("已经使用的缓冲区大小")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_buffer_total_capacity_bytes")]),t._v(" "),_("td",[t._v('id="direct/mapped"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("最大缓冲区大小")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_buffer_count_buffers")]),t._v(" "),_("td",[t._v('id="direct/mapped"')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("当前缓冲区数量")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_memory_committed_bytes")]),t._v(" "),_("td",[t._v('{area="heap/nonheap",id="xxx",}')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("当前申请的内存大小")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_memory_max_bytes")]),t._v(" "),_("td",[t._v('{area="heap/nonheap",id="xxx",}')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("最大内存")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_memory_used_bytes")]),t._v(" "),_("td",[t._v('{area="heap/nonheap",id="xxx",}')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("已使用内存大小")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-15-jvm-类加载统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-15-jvm-类加载统计"}},[t._v("#")]),t._v(" 4.2.15. JVM 类加载统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("jvm_classes_unloaded_classes")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("累计卸载的class数量")])]),t._v(" "),_("tr",[_("td",[t._v("jvm_classes_loaded_classes")]),t._v(" "),_("td"),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("累计加载的class数量")])])])]),t._v(" "),_("h3",{attrs:{id:"_4-2-16-jvm-编译时间统计"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-16-jvm-编译时间统计"}},[t._v("#")]),t._v(" 4.2.16. JVM 编译时间统计")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("Metric")]),t._v(" "),_("th",[t._v("Tags")]),t._v(" "),_("th",[t._v("Type")]),t._v(" "),_("th",[t._v("Description")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("jvm_compilation_time_ms")]),t._v(" "),_("td",[t._v('{compiler="HotSpot 64-Bit Tiered Compilers",}')]),t._v(" "),_("td",[t._v("AutoGauge")]),t._v(" "),_("td",[t._v("耗费在编译上的时间")])])])]),t._v(" "),_("h2",{attrs:{id:"_4-3-all-级别监控指标"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-all-级别监控指标"}},[t._v("#")]),t._v(" 4.3. All 级别监控指标")]),t._v(" "),_("p",[t._v("目前还没有All级别的监控指标，后续会持续添加。")]),t._v(" "),_("h1",{attrs:{id:"_5-怎样获取这些系统监控"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-怎样获取这些系统监控"}},[t._v("#")]),t._v(" 5. 怎样获取这些系统监控？")]),t._v(" "),_("ul",[_("li",[t._v("监控模块的相关配置均在"),_("code",[t._v("conf/iotdb-{datanode/confignode}.properties")]),t._v("中，所有配置项支持通过"),_("code",[t._v("load configuration")]),t._v("命令热加载。")])]),t._v(" "),_("h2",{attrs:{id:"_5-1-使用-jmx-方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-使用-jmx-方式"}},[t._v("#")]),t._v(" 5.1. 使用 JMX 方式")]),t._v(" "),_("p",[t._v("对于使用 JMX 对外暴露的指标，可以通过 Jconsole 来进行查看。在进入 Jconsole 监控页面后，首先会看到 IoTDB 的各类运行情况的概览。在这里，您可以看到堆内存信息、线程信息、类信息以及服务器的 CPU 使用情况。")]),t._v(" "),_("h3",{attrs:{id:"_5-1-1-获取监控指标数据"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-1-获取监控指标数据"}},[t._v("#")]),t._v(" 5.1.1. 获取监控指标数据")]),t._v(" "),_("p",[t._v('连接到 JMX 后，您可以通过 "MBeans" 标签找到名为 "org.apache.iotdb.metrics" 的 "MBean"，可以在侧边栏中查看所有监控指标的具体值。')]),t._v(" "),_("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{alt:"metric-jmx",src:"https://user-images.githubusercontent.com/46039728/204018765-6fda9391-ebcf-4c80-98c5-26f34bd74df0.png"}}),t._v(" "),_("h3",{attrs:{id:"_5-1-2-获取其他相关数据"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-2-获取其他相关数据"}},[t._v("#")]),t._v(" 5.1.2. 获取其他相关数据")]),t._v(" "),_("p",[t._v('连接到 JMX 后，您可以通过 "MBeans" 标签找到名为 "org.apache.iotdb.service" 的 "MBean"，如下图所示，了解服务的基本状态')]),t._v(" "),_("p",[_("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{src:"https://user-images.githubusercontent.com/46039728/149951720-707f1ee8-32ee-4fde-9252-048caebd232e.png"}}),t._v(" "),_("br")]),t._v(" "),_("p",[t._v("为了提高查询性能，IOTDB 对 ChunkMetaData 和 TsFileMetaData 进行了缓存。用户可以使用 MXBean ，展开侧边栏"),_("code",[t._v("org.apache.iotdb.db.service")]),t._v("查看缓存命中率：")]),t._v(" "),_("img",{staticStyle:{width:"100%","max-width":"800px","max-height":"600px","margin-left":"auto","margin-right":"auto",display:"block"},attrs:{src:"https://user-images.githubusercontent.com/19167280/112426760-73e3da80-8d73-11eb-9a8f-9232d1f2033b.png"}}),t._v(" "),_("h2",{attrs:{id:"_5-2-使用-prometheus-方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-使用-prometheus-方式"}},[t._v("#")]),t._v(" 5.2. 使用 Prometheus 方式")]),t._v(" "),_("h3",{attrs:{id:"_5-2-1-监控指标的-prometheus-映射关系"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-监控指标的-prometheus-映射关系"}},[t._v("#")]),t._v(" 5.2.1. 监控指标的 Prometheus 映射关系")]),t._v(" "),_("blockquote",[_("p",[t._v("对于 Metric Name 为 name, Tags 为 K1=V1, ..., Kn=Vn 的监控指标有如下映射，其中 value 为具体值")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("监控指标类型")]),t._v(" "),_("th",[t._v("映射关系")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v('name_total{k1="V1", ..., Kn="Vn"} value')])]),t._v(" "),_("tr",[_("td",[t._v("AutoGauge、Gauge")]),t._v(" "),_("td",[t._v('name{k1="V1", ..., Kn="Vn"} value')])]),t._v(" "),_("tr",[_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v('name_max{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name_sum{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name_count{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name{k1="V1", ..., Kn="Vn", quantile="0.0"} value '),_("br"),t._v(' name{k1="V1", ..., Kn="Vn", quantile="0.25"} value '),_("br"),t._v(' name{k1="V1", ..., Kn="Vn", quantile="0.5"} value '),_("br"),t._v(' name{k1="V1", ..., Kn="Vn", quantile="0.75"} value '),_("br"),t._v(' name{k1="V1", ..., Kn="Vn", quantile="1.0"} value')])]),t._v(" "),_("tr",[_("td",[t._v("Rate")]),t._v(" "),_("td",[t._v('name_total{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name_total{k1="V1", ..., Kn="Vn", rate="m1"} value '),_("br"),t._v(' name_total{k1="V1", ..., Kn="Vn", rate="m5"} value  '),_("br"),t._v(' name_total{k1="V1", ..., Kn="Vn", rate="m15"} value '),_("br"),t._v(' name_total{k1="V1", ..., Kn="Vn", rate="mean"} value')])]),t._v(" "),_("tr",[_("td",[t._v("Timer")]),t._v(" "),_("td",[t._v('name_seconds_max{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name_seconds_sum{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name_seconds_count{k1="V1", ..., Kn="Vn"} value '),_("br"),t._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.0"} value '),_("br"),t._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.25"} value '),_("br"),t._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.5"} value '),_("br"),t._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="0.75"} value '),_("br"),t._v(' name_seconds{k1="V1", ..., Kn="Vn", quantile="1.0"} value')])])])]),t._v(" "),_("h3",{attrs:{id:"_5-2-2-修改配置文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-2-修改配置文件"}},[t._v("#")]),t._v(" 5.2.2. 修改配置文件")]),t._v(" "),_("ol",[_("li",[t._v("以 DataNode 为例，修改 iotdb-datanode.properties 配置文件如下：")])]),t._v(" "),_("div",{staticClass:"language-properties line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-properties"}},[_("code",[_("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dn_metric_reporter_list")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),_("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("PROMETHEUS")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dn_metric_level")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),_("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("CORE")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("dn_metric_prometheus_reporter_port")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),_("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("9091")]),t._v("\n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br")])]),_("ol",{attrs:{start:"2"}},[_("li",[_("p",[t._v("启动 IoTDB DataNode")])]),t._v(" "),_("li",[_("p",[t._v("打开浏览器或者用"),_("code",[t._v("curl")]),t._v(" 访问 "),_("code",[t._v("http://servier_ip:9091/metrics")]),t._v(", 就能得到如下 metric 数据：")])])]),t._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v('...\n# HELP file_count\n# TYPE file_count gauge\nfile_count{name="wal",} 0.0\nfile_count{name="unseq",} 0.0\nfile_count{name="seq",} 2.0\n...\n')])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br"),_("span",{staticClass:"line-number"},[t._v("6")]),_("br"),_("span",{staticClass:"line-number"},[t._v("7")]),_("br")])]),_("h3",{attrs:{id:"_5-2-3-prometheus-grafana"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-3-prometheus-grafana"}},[t._v("#")]),t._v(" 5.2.3. Prometheus + Grafana")]),t._v(" "),_("p",[t._v("如上所示，IoTDB 对外暴露出标准的 Prometheus 格式的监控指标数据，可以使用 Prometheus 采集并存储监控指标，使用 Grafana 可视化监控指标。")]),t._v(" "),_("p",[t._v("IoTDB、Prometheus、Grafana三者的关系如下图所示:")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://raw.githubusercontent.com/apache/iotdb-bin-resources/main/docs/UserGuide/System%20Tools/Metrics/iotdb_prometheus_grafana.png",alt:"iotdb_prometheus_grafana"}})]),t._v(" "),_("ol",[_("li",[t._v("IoTDB在运行过程中持续收集监控指标数据。")]),t._v(" "),_("li",[t._v("Prometheus以固定的间隔（可配置）从IoTDB的HTTP接口拉取监控指标数据。")]),t._v(" "),_("li",[t._v("Prometheus将拉取到的监控指标数据存储到自己的TSDB中。")]),t._v(" "),_("li",[t._v("Grafana以固定的间隔（可配置）从Prometheus查询监控指标数据并绘图展示。")])]),t._v(" "),_("p",[t._v("从交互流程可以看出，我们需要做一些额外的工作来部署和配置Prometheus和Grafana。")]),t._v(" "),_("p",[t._v("比如，你可以对Prometheus进行如下的配置（部分参数可以自行调整）来从IoTDB获取监控数据")]),t._v(" "),_("div",{staticClass:"language-yaml line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-yaml"}},[_("code",[_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pull"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("metrics\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("honor_labels")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("honor_timestamps")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_interval")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 15s\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scrape_timeout")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 10s\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metrics_path")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /metrics\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("scheme")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("follow_redirects")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" localhost"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("9091")]),t._v("\n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br"),_("span",{staticClass:"line-number"},[t._v("6")]),_("br"),_("span",{staticClass:"line-number"},[t._v("7")]),_("br"),_("span",{staticClass:"line-number"},[t._v("8")]),_("br"),_("span",{staticClass:"line-number"},[t._v("9")]),_("br"),_("span",{staticClass:"line-number"},[t._v("10")]),_("br"),_("span",{staticClass:"line-number"},[t._v("11")]),_("br")])]),_("p",[t._v("更多细节可以参考下面的文档：")]),t._v(" "),_("p",[_("a",{attrs:{href:"https://prometheus.io/docs/prometheus/latest/getting_started/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus安装使用文档"),_("OutboundLink")],1)]),t._v(" "),_("p",[_("a",{attrs:{href:"https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus从HTTP接口拉取metrics数据的配置说明"),_("OutboundLink")],1)]),t._v(" "),_("p",[_("a",{attrs:{href:"https://grafana.com/docs/grafana/latest/getting-started/getting-started/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana安装使用文档"),_("OutboundLink")],1)]),t._v(" "),_("p",[_("a",{attrs:{href:"https://prometheus.io/docs/visualization/grafana/#grafana-support-for-prometheus",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana从Prometheus查询数据并绘图的文档"),_("OutboundLink")],1)]),t._v(" "),_("h3",{attrs:{id:"_5-2-4-apache-iotdb-dashboard"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-apache-iotdb-dashboard"}},[t._v("#")]),t._v(" 5.2.4. Apache IoTDB Dashboard")]),t._v(" "),_("p",[t._v("我们提供了Apache IoTDB Dashboard，在Grafana中显示的效果图如下所示：")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://github.com/apache/iotdb-bin-resources/blob/main/docs/UserGuide/System%20Tools/Metrics/dashboard.png",alt:"Apache IoTDB Dashboard"}})]),t._v(" "),_("h4",{attrs:{id:"_5-2-4-1-如何获取-apache-iotdb-dashboard"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-1-如何获取-apache-iotdb-dashboard"}},[t._v("#")]),t._v(" 5.2.4.1. 如何获取 Apache IoTDB Dashboard？")]),t._v(" "),_("ol",[_("li",[t._v("您可以在 grafana-metrics-example 文件夹下获取到对应不同iotdb版本的Dashboard的json文件。")]),t._v(" "),_("li",[t._v("您可以访问"),_("a",{attrs:{href:"https://grafana.com/grafana/dashboards/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana Dashboard官网"),_("OutboundLink")],1),t._v("搜索"),_("code",[t._v("Apache IoTDB Dashboard")]),t._v("并使用")])]),t._v(" "),_("p",[t._v("在创建Grafana时，您可以选择Import刚刚下载的json文件，并为Apache IoTDB Dashboard选择对应目标数据源。")]),t._v(" "),_("h4",{attrs:{id:"_5-2-4-2-apache-iotdb-confignode-dashboard-说明"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-2-apache-iotdb-confignode-dashboard-说明"}},[t._v("#")]),t._v(" 5.2.4.2. Apache IoTDB ConfigNode Dashboard 说明")]),t._v(" "),_("blockquote",[_("p",[t._v("除特殊说明的监控项以外，以下监控项均保证在Important级别的监控框架中可用。")])]),t._v(" "),_("ul",[_("li",[_("code",[t._v("Overview")]),t._v("：系统概述\n"),_("ul",[_("li",[_("code",[t._v("Registered Node")]),t._v("：注册的ConfigNode/DataNode个数")]),t._v(" "),_("li",[_("code",[t._v("DataNode")]),t._v("：集群DataNode的存活状态，包括Online和Unknown两种。")]),t._v(" "),_("li",[_("code",[t._v("ConfigNode")]),t._v("：集群ConfigNode的存活状态，包括Online和Unknown两种。")]),t._v(" "),_("li",[_("code",[t._v("The Status Of Node")]),t._v("：集群具体节点运行状态，包括Online和Unkown两种。")])])]),t._v(" "),_("li",[_("code",[t._v("Region")]),t._v("：Region概述\n"),_("ul",[_("li",[_("code",[t._v("Region Number")]),t._v("：Region个数，包括总个数，DataRegion 个数和 SchemaRegion 个数。")]),t._v(" "),_("li",[_("code",[t._v("Leadership distribution")]),t._v("：集群 Leader 分布情况，指每个节点上对应 Region 的 Leader 的个数。")]),t._v(" "),_("li",[_("code",[t._v("Total Region in Node")]),t._v("：不同 Node 的 Region 总数量。")]),t._v(" "),_("li",[_("code",[t._v("Region in Node")]),t._v("：不同 Node 的 SchemaRegion/DataRegion 数量。")]),t._v(" "),_("li",[_("code",[t._v("Region in Database")]),t._v("（Normal级别）：不同 Database 的 Region 数量，包括 SchemaRegion、DataRegion。")]),t._v(" "),_("li",[_("code",[t._v("Slot in Database")]),t._v("(Normal级别)：不同 Database 的Slot数量，包括 DataSlot 数量和 SchemaSlot 数量。")])])]),t._v(" "),_("li",[_("code",[t._v("System")]),t._v("：系统\n"),_("ul",[_("li",[_("code",[t._v("CPU Core")]),t._v("：系统 CPU 核数情况。")]),t._v(" "),_("li",[_("code",[t._v("CPU Load")]),t._v("：系统 CPU 负载情况、进度 CPU 负载情况。")]),t._v(" "),_("li",[_("code",[t._v("CPU Time Per Minute")]),t._v("：进程平均每分钟占用系统 CPU 时间，注意：多核会导致该值超过1分钟。")]),t._v(" "),_("li",[_("code",[t._v("System Memory")]),t._v("：系统物理内存大小、系统使用物理内存大小、虚拟机提交的内存大小。")]),t._v(" "),_("li",[_("code",[t._v("System Swap Size")]),t._v("：系统交换区总大小、系统交换区使用大小。")]),t._v(" "),_("li",[_("code",[t._v("Process Memory")]),t._v("：IoTDB 进程最大内存总大小、IoTDB 进程总内存大小、IoTDB 进程使用内存大小。")]),t._v(" "),_("li",[_("code",[t._v("The Number of GC Per Minute")]),t._v("：平均每分钟 GC 次数。")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed Of GC Per Minute")]),t._v("：平均每分钟 GC 耗时。")]),t._v(" "),_("li",[_("code",[t._v("The Number Of Java Thread")]),t._v("：IoTDB 进程的不同状态的线程数。")]),t._v(" "),_("li",[_("code",[t._v("Heap Memory")]),t._v("：IoTDB 进程的堆内存")]),t._v(" "),_("li",[_("code",[t._v("Off Heap Memory")]),t._v("：IoTDB 进程的堆外内存")]),t._v(" "),_("li",[_("code",[t._v("Log Number Per Minute")]),t._v("：IoTDB 进程平均每分钟日志数")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed of Compliation Per Minute")]),t._v("：平均每分钟编译耗时")]),t._v(" "),_("li",[_("code",[t._v("The Number Of Class")]),t._v("：JVM 加载和卸载的类数量")])])])]),t._v(" "),_("h4",{attrs:{id:"_5-2-4-3-apache-iotdb-datanode-dashboard-说明"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-4-3-apache-iotdb-datanode-dashboard-说明"}},[t._v("#")]),t._v(" 5.2.4.3. Apache IoTDB DataNode Dashboard 说明")]),t._v(" "),_("blockquote",[_("p",[t._v("除特殊说明的监控项以外，以下监控项均保证在Important级别的监控框架中可用。")])]),t._v(" "),_("ul",[_("li",[_("code",[t._v("Overview")]),t._v("：系统概述\n"),_("ul",[_("li",[_("code",[t._v("The Number Of Entity")]),t._v("：实体数量，包含时间序列等")]),t._v(" "),_("li",[_("code",[t._v("Write Point Per Minute")]),t._v("：每分钟系统平均写入点数")]),t._v(" "),_("li",[_("code",[t._v("Database Used Memory")]),t._v("：每个 Database 使用的内存大小")])])]),t._v(" "),_("li",[_("code",[t._v("Interface")]),t._v("：接口\n"),_("ul",[_("li",[_("code",[t._v("The Time Consumed Of Operation(50%)")]),t._v("：不同客户端操作耗时的中位数")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed Of Operation(75%)")]),t._v("：不同客户端操作耗时的上四分位数")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed Of Operation(100%)")]),t._v("：不同客户端操作耗时的最大值")]),t._v(" "),_("li",[_("code",[t._v("The QPS of Interface")]),t._v("：系统接口每秒钟访问次数")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed Of Interface")]),t._v("：系统接口的平均耗时")]),t._v(" "),_("li",[_("code",[t._v("Cache Hit Rate")]),t._v("：缓存命中率")]),t._v(" "),_("li",[_("code",[t._v("Thrift Connection")]),t._v("：建立的 Thrift 连接个数")]),t._v(" "),_("li",[_("code",[t._v("Thrift Active Thread")]),t._v("：建立的活跃的 Thrift 连接的个数")])])]),t._v(" "),_("li",[_("code",[t._v("Engine")]),t._v("：引擎\n"),_("ul",[_("li",[_("code",[t._v("Task Number")]),t._v("：系统中不同状态的任务个数")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed Of Tasking")]),t._v("：系统中不同状态的任务的耗时")]),t._v(" "),_("li",[_("code",[t._v("Compaction Read And Write Per Minute")]),t._v("：平均每分钟合并读取和写入数据量")]),t._v(" "),_("li",[_("code",[t._v("Compaction R/W Ratio Per Minute")]),t._v("：平均每分钟合并读取和写入数据比")]),t._v(" "),_("li",[_("code",[t._v("Compaction Number Per Minute")]),t._v("：平均每分钟不同类型的合并任务数量")])])]),t._v(" "),_("li",[_("code",[t._v("IoTConsensus")]),t._v("：IoT共识协议\n"),_("ul",[_("li",[_("code",[t._v("IoTConsensus Used Memory")]),t._v("：IoT共识层使用的内存大小")]),t._v(" "),_("li",[_("code",[t._v("IoTConsensus Sync Index")]),t._v("：不同的Region的写入Index和同步Index")]),t._v(" "),_("li",[_("code",[t._v("IoTConsensus Overview")]),t._v("：不同节点的同步总差距、总缓存的请求个数")]),t._v(" "),_("li",[_("code",[t._v("The time consumed of different stages(50%)")]),t._v("：不同阶段耗时的中位数")]),t._v(" "),_("li",[_("code",[t._v("The time consumed of different stages(75%)")]),t._v("：不同阶段耗时的上四分位数")]),t._v(" "),_("li",[_("code",[t._v("The time consumed of different stages(100%)")]),t._v("：不同阶段耗时的最大值")]),t._v(" "),_("li",[_("code",[t._v("IoTConsensus Search Index Rate")]),t._v("：不同region的写入Index的增长速度")]),t._v(" "),_("li",[_("code",[t._v("IoTConsensus Safe Index Rate")]),t._v("：不同region的同步Index的增长速度")]),t._v(" "),_("li",[_("code",[t._v("IoTConsensus LogDispatcher Request Size")]),t._v("：不同的LogDispatcherThread缓存的请求个数")]),t._v(" "),_("li",[_("code",[t._v("Sync Lag")]),t._v("：每个region的同步index差距")]),t._v(" "),_("li",[_("code",[t._v("Min Peer Sync Lag")]),t._v("：每个region的写入index和同步最快的LogDispatcherThread的同步index之间的差距")]),t._v(" "),_("li",[_("code",[t._v("Sync speed diff of Peers")]),t._v("：每个region中同步最快的LogDispatcherThread与同步最慢的LogDispatcherThread之间的同步index差距")])])]),t._v(" "),_("li",[_("code",[t._v("System")]),t._v("：系统\n"),_("ul",[_("li",[_("code",[t._v("CPU Core")]),t._v("：系统 CPU 核数情况。")]),t._v(" "),_("li",[_("code",[t._v("CPU Load")]),t._v("：系统 CPU 负载情况、进度 CPU 负载情况。")]),t._v(" "),_("li",[_("code",[t._v("CPU Time Per Minute")]),t._v("：进程平均每分钟占用系统 CPU 时间，注意：多核会导致该值超过1分钟。")]),t._v(" "),_("li",[_("code",[t._v("System Memory")]),t._v("：系统物理内存大小、系统使用物理内存大小、虚拟机提交的内存大小。")]),t._v(" "),_("li",[_("code",[t._v("System Swap Size")]),t._v("：系统交换区总大小、系统交换区使用大小。")]),t._v(" "),_("li",[_("code",[t._v("Process Memory")]),t._v("：IoTDB 进程最大内存总大小、IoTDB 进程总内存大小、IoTDB 进程使用内存大小。")]),t._v(" "),_("li",[_("code",[t._v("The Size Of File")]),t._v("：IoTDB系统相关的文件大小，包括wal下的文件总大小、seq下的tsfile文件总大小、unseq下的tsfile文件总大小")]),t._v(" "),_("li",[_("code",[t._v("The Number Of File")]),t._v("：IoTDB系统相关的文件个数，包括wal下的文件个数、seq下的tsfile文件个数、unseq下的tsfile文件个数")]),t._v(" "),_("li",[_("code",[t._v("The Space Of Disk")]),t._v("：当前data目录所挂载的磁盘总大小和剩余大小")]),t._v(" "),_("li",[_("code",[t._v("The Number of GC Per Minute")]),t._v("：平均每分钟 GC 次数。")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed Of GC Per Minute")]),t._v("：平均每分钟 GC 耗时。")]),t._v(" "),_("li",[_("code",[t._v("The Number Of Java Thread")]),t._v("：IoTDB 进程的不同状态的线程数。")]),t._v(" "),_("li",[_("code",[t._v("Heap Memory")]),t._v("：IoTDB 进程的堆内存")]),t._v(" "),_("li",[_("code",[t._v("Off Heap Memory")]),t._v("：IoTDB 进程的堆外内存")]),t._v(" "),_("li",[_("code",[t._v("Log Number Per Minute")]),t._v("：IoTDB 进程平均每分钟日志数")]),t._v(" "),_("li",[_("code",[t._v("The Time Consumed of Compliation Per Minute")]),t._v("：平均每分钟编译耗时")]),t._v(" "),_("li",[_("code",[t._v("The Number Of Class")]),t._v("：JVM 加载和卸载的类数量")])])])]),t._v(" "),_("h2",{attrs:{id:"_5-3-使用-iotdb-方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-使用-iotdb-方式"}},[t._v("#")]),t._v(" 5.3. 使用 IoTDB 方式")]),t._v(" "),_("h3",{attrs:{id:"_5-3-1-监控指标的-iotdb-映射关系"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-监控指标的-iotdb-映射关系"}},[t._v("#")]),t._v(" 5.3.1. 监控指标的 IoTDB 映射关系")]),t._v(" "),_("blockquote",[_("p",[t._v("对于 Metric Name 为 name, Tags 为 K1=V1, ..., Kn=Vn 的监控指标有如下映射，以默认写到 root.__system.metric 为例")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("监控指标类型")]),t._v(" "),_("th",[t._v("映射关系")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("Counter")]),t._v(" "),_("td",[t._v("root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".value")])]),t._v(" "),_("tr",[_("td",[t._v("AutoGauge、Gauge")]),t._v(" "),_("td",[t._v("root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".value")])]),t._v(" "),_("tr",[_("td",[t._v("Histogram")]),t._v(" "),_("td",[t._v("root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".count "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".max "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".sum "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p0 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p25 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p50 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p75 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p100")])]),t._v(" "),_("tr",[_("td",[t._v("Rate")]),t._v(" "),_("td",[t._v("root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".count "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".mean "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".m1 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".m5 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".m15")])]),t._v(" "),_("tr",[_("td",[t._v("Timer")]),t._v(" "),_("td",[t._v("root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".count "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".max "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".mean "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".sum "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p0 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p25 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p50 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p75 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".p100   "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".m1 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".m5 "),_("br"),t._v(" root.__system.metric.name."),_("code",[t._v("K1=V1")]),t._v("..."),_("code",[t._v("Kn=Vn")]),t._v(".m15")])])])]),t._v(" "),_("h3",{attrs:{id:"_5-3-2-获取监控指标"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-获取监控指标"}},[t._v("#")]),t._v(" 5.3.2. 获取监控指标")]),t._v(" "),_("p",[t._v("根据如上的映射关系，可以构成相关的 IoTDB 查询语句获取监控指标")])])}),[],!1,null,null,null);_.default=a.exports}}]);