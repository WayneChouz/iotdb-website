<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title> </title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content=" ">
    <meta name="Description" content="Apache IoTDB: Time Series Database for IoT">
    <meta name="Keywords" content="TSDB, time series, time series database, IoTDB, IoT database, IoT data management,时序数据库, 时间序列管理, IoTDB, 物联网数据库, 实时数据库, 物联网数据管理, 物联网数据">
    <meta name="baidu-site-verification" content="wfKETzB3OT">
    <meta name="google-site-verification" content="mZWAoRY0yj_HAr-s47zHCGHzx5Ju-RVm5wDbPnwQYFo">
    
    <link rel="preload" href="/assets/css/0.styles.53b4846f.css" as="style"><link rel="preload" href="/assets/js/app.7e8d0fee.js" as="script"><link rel="preload" href="/assets/js/3.187083c5.js" as="script"><link rel="preload" href="/assets/js/190.02ee3914.js" as="script"><link rel="prefetch" href="/assets/js/10.1c603655.js"><link rel="prefetch" href="/assets/js/100.dab6e75e.js"><link rel="prefetch" href="/assets/js/101.d7637f69.js"><link rel="prefetch" href="/assets/js/102.4b31669b.js"><link rel="prefetch" href="/assets/js/103.df8a636e.js"><link rel="prefetch" href="/assets/js/104.f8b25f0c.js"><link rel="prefetch" href="/assets/js/105.a836abb5.js"><link rel="prefetch" href="/assets/js/106.62b870a3.js"><link rel="prefetch" href="/assets/js/107.f0bd827e.js"><link rel="prefetch" href="/assets/js/108.c6eec2f2.js"><link rel="prefetch" href="/assets/js/109.7a339e3c.js"><link rel="prefetch" href="/assets/js/11.cc3f9ffd.js"><link rel="prefetch" href="/assets/js/110.a0f4b386.js"><link rel="prefetch" href="/assets/js/111.002e30f1.js"><link rel="prefetch" href="/assets/js/112.e124c29e.js"><link rel="prefetch" href="/assets/js/113.fab59901.js"><link rel="prefetch" href="/assets/js/114.e5335893.js"><link rel="prefetch" href="/assets/js/115.be4e1fe4.js"><link rel="prefetch" href="/assets/js/116.c0dd7d85.js"><link rel="prefetch" href="/assets/js/117.81bb9bd1.js"><link rel="prefetch" href="/assets/js/118.eab6d5d4.js"><link rel="prefetch" href="/assets/js/119.8b54e7ae.js"><link rel="prefetch" href="/assets/js/12.b8a206cd.js"><link rel="prefetch" href="/assets/js/120.463b32a1.js"><link rel="prefetch" href="/assets/js/121.2ff179d1.js"><link rel="prefetch" href="/assets/js/122.4c390b2a.js"><link rel="prefetch" href="/assets/js/123.cd83f28a.js"><link rel="prefetch" href="/assets/js/124.113d9fba.js"><link rel="prefetch" href="/assets/js/125.c47a236e.js"><link rel="prefetch" href="/assets/js/126.cb13b873.js"><link rel="prefetch" href="/assets/js/127.b873082f.js"><link rel="prefetch" href="/assets/js/128.721d8520.js"><link rel="prefetch" href="/assets/js/129.0705d848.js"><link rel="prefetch" href="/assets/js/13.5c4247f9.js"><link rel="prefetch" href="/assets/js/130.b08ee2d9.js"><link rel="prefetch" href="/assets/js/131.eb1d2143.js"><link rel="prefetch" href="/assets/js/132.7fc7790c.js"><link rel="prefetch" href="/assets/js/133.87ec58e5.js"><link rel="prefetch" href="/assets/js/134.5b4d2b78.js"><link rel="prefetch" href="/assets/js/135.4b41db8a.js"><link rel="prefetch" href="/assets/js/136.85219757.js"><link rel="prefetch" href="/assets/js/137.3c2decde.js"><link rel="prefetch" href="/assets/js/138.648415d4.js"><link rel="prefetch" href="/assets/js/139.033ce790.js"><link rel="prefetch" href="/assets/js/14.14c0a23e.js"><link rel="prefetch" href="/assets/js/140.6bc7e5cc.js"><link rel="prefetch" href="/assets/js/141.317d3508.js"><link rel="prefetch" href="/assets/js/142.305de246.js"><link rel="prefetch" href="/assets/js/143.9807221d.js"><link rel="prefetch" href="/assets/js/144.1b7ea921.js"><link rel="prefetch" href="/assets/js/145.58d5d173.js"><link rel="prefetch" href="/assets/js/146.2f1ee190.js"><link rel="prefetch" href="/assets/js/147.8de4b5d5.js"><link rel="prefetch" href="/assets/js/148.29aae04a.js"><link rel="prefetch" href="/assets/js/149.6942d809.js"><link rel="prefetch" href="/assets/js/15.42f29f2e.js"><link rel="prefetch" href="/assets/js/150.833ba50d.js"><link rel="prefetch" href="/assets/js/151.fe221764.js"><link rel="prefetch" href="/assets/js/152.8c1abcbd.js"><link rel="prefetch" href="/assets/js/153.36f1af7a.js"><link rel="prefetch" href="/assets/js/154.d79829b5.js"><link rel="prefetch" href="/assets/js/155.f434a865.js"><link rel="prefetch" href="/assets/js/156.d9791f95.js"><link rel="prefetch" href="/assets/js/157.81dfde33.js"><link rel="prefetch" href="/assets/js/158.a4eccc5e.js"><link rel="prefetch" href="/assets/js/159.e18992b6.js"><link rel="prefetch" href="/assets/js/16.2114635f.js"><link rel="prefetch" href="/assets/js/160.2d69e069.js"><link rel="prefetch" href="/assets/js/161.2b986cf2.js"><link rel="prefetch" href="/assets/js/162.a2148c19.js"><link rel="prefetch" href="/assets/js/163.4bd0b3f4.js"><link rel="prefetch" href="/assets/js/164.e9ba602d.js"><link rel="prefetch" href="/assets/js/165.6d0a70b8.js"><link rel="prefetch" href="/assets/js/166.92f2a067.js"><link rel="prefetch" href="/assets/js/167.fadc6ed7.js"><link rel="prefetch" href="/assets/js/168.be19af7c.js"><link rel="prefetch" href="/assets/js/169.cbaae9e6.js"><link rel="prefetch" href="/assets/js/17.24e8b4f8.js"><link rel="prefetch" href="/assets/js/170.e2c608ba.js"><link rel="prefetch" href="/assets/js/171.0ada7198.js"><link rel="prefetch" href="/assets/js/172.26a85bbd.js"><link rel="prefetch" href="/assets/js/173.2eb7c3bb.js"><link rel="prefetch" href="/assets/js/174.7a120de2.js"><link rel="prefetch" href="/assets/js/175.a93318f6.js"><link rel="prefetch" href="/assets/js/176.6ad35d9c.js"><link rel="prefetch" href="/assets/js/177.30d70860.js"><link rel="prefetch" href="/assets/js/178.2bfe4516.js"><link rel="prefetch" href="/assets/js/179.229d373e.js"><link rel="prefetch" href="/assets/js/18.df811665.js"><link rel="prefetch" href="/assets/js/180.2a5566b7.js"><link rel="prefetch" href="/assets/js/181.8033dea4.js"><link rel="prefetch" href="/assets/js/182.3d4f481d.js"><link rel="prefetch" href="/assets/js/183.071b717c.js"><link rel="prefetch" href="/assets/js/184.5db69127.js"><link rel="prefetch" href="/assets/js/185.64ed7eb9.js"><link rel="prefetch" href="/assets/js/186.a2c59ddc.js"><link rel="prefetch" href="/assets/js/187.935e8efe.js"><link rel="prefetch" href="/assets/js/188.0b366a8d.js"><link rel="prefetch" href="/assets/js/189.7e07e916.js"><link rel="prefetch" href="/assets/js/19.4a1a4263.js"><link rel="prefetch" href="/assets/js/191.993b3775.js"><link rel="prefetch" href="/assets/js/192.571715fe.js"><link rel="prefetch" href="/assets/js/193.5b7aac46.js"><link rel="prefetch" href="/assets/js/194.3ef7659f.js"><link rel="prefetch" href="/assets/js/195.1741a0c1.js"><link rel="prefetch" href="/assets/js/196.4f334405.js"><link rel="prefetch" href="/assets/js/197.9aeeecbf.js"><link rel="prefetch" href="/assets/js/198.3f6c379f.js"><link rel="prefetch" href="/assets/js/199.5a3d16de.js"><link rel="prefetch" href="/assets/js/20.1b6deffc.js"><link rel="prefetch" href="/assets/js/200.1d2045a3.js"><link rel="prefetch" href="/assets/js/201.55db87cf.js"><link rel="prefetch" href="/assets/js/202.f42da840.js"><link rel="prefetch" href="/assets/js/203.dcc0df47.js"><link rel="prefetch" href="/assets/js/204.1ede630a.js"><link rel="prefetch" href="/assets/js/205.93704d14.js"><link rel="prefetch" href="/assets/js/206.f002fb3f.js"><link rel="prefetch" href="/assets/js/207.154d90f0.js"><link rel="prefetch" href="/assets/js/208.a0da203c.js"><link rel="prefetch" href="/assets/js/209.e0324575.js"><link rel="prefetch" href="/assets/js/21.28cc5d92.js"><link rel="prefetch" href="/assets/js/210.d703707b.js"><link rel="prefetch" href="/assets/js/211.a37a3003.js"><link rel="prefetch" href="/assets/js/212.1cc86b47.js"><link rel="prefetch" href="/assets/js/213.6e7a321e.js"><link rel="prefetch" href="/assets/js/214.582bf30f.js"><link rel="prefetch" href="/assets/js/215.a84ee040.js"><link rel="prefetch" href="/assets/js/216.372ca744.js"><link rel="prefetch" href="/assets/js/217.5fd5f8d2.js"><link rel="prefetch" href="/assets/js/218.b83d58fb.js"><link rel="prefetch" href="/assets/js/219.0ac1318f.js"><link rel="prefetch" href="/assets/js/22.75220083.js"><link rel="prefetch" href="/assets/js/220.4d78c5f4.js"><link rel="prefetch" href="/assets/js/221.cd2acc28.js"><link rel="prefetch" href="/assets/js/222.aaf5340a.js"><link rel="prefetch" href="/assets/js/223.7fd4a659.js"><link rel="prefetch" href="/assets/js/224.ba03cf4f.js"><link rel="prefetch" href="/assets/js/225.99e825d5.js"><link rel="prefetch" href="/assets/js/226.89569d80.js"><link rel="prefetch" href="/assets/js/227.a29c3a08.js"><link rel="prefetch" href="/assets/js/228.6fc8489e.js"><link rel="prefetch" href="/assets/js/229.918432b1.js"><link rel="prefetch" href="/assets/js/23.d200be4a.js"><link rel="prefetch" href="/assets/js/230.b834d921.js"><link rel="prefetch" href="/assets/js/231.12ec6410.js"><link rel="prefetch" href="/assets/js/232.1f1f141f.js"><link rel="prefetch" href="/assets/js/233.a260e8a0.js"><link rel="prefetch" href="/assets/js/234.7185ad8d.js"><link rel="prefetch" href="/assets/js/235.54ca025d.js"><link rel="prefetch" href="/assets/js/236.079080e9.js"><link rel="prefetch" href="/assets/js/237.6b434c25.js"><link rel="prefetch" href="/assets/js/238.9d98999f.js"><link rel="prefetch" href="/assets/js/239.9dbe10a0.js"><link rel="prefetch" href="/assets/js/24.bd10c191.js"><link rel="prefetch" href="/assets/js/240.8c591dd3.js"><link rel="prefetch" href="/assets/js/241.88e26f0b.js"><link rel="prefetch" href="/assets/js/242.2bfda616.js"><link rel="prefetch" href="/assets/js/243.c9f0ff67.js"><link rel="prefetch" href="/assets/js/244.78f7b606.js"><link rel="prefetch" href="/assets/js/245.45b1933a.js"><link rel="prefetch" href="/assets/js/246.a02c461b.js"><link rel="prefetch" href="/assets/js/247.76f0573f.js"><link rel="prefetch" href="/assets/js/248.6ae8c5c7.js"><link rel="prefetch" href="/assets/js/249.ee32bf93.js"><link rel="prefetch" href="/assets/js/25.cf534808.js"><link rel="prefetch" href="/assets/js/250.38d40712.js"><link rel="prefetch" href="/assets/js/251.4f0b12fb.js"><link rel="prefetch" href="/assets/js/252.54e44c81.js"><link rel="prefetch" href="/assets/js/253.f4a0f771.js"><link rel="prefetch" href="/assets/js/254.55bb81a5.js"><link rel="prefetch" href="/assets/js/255.b03e2837.js"><link rel="prefetch" href="/assets/js/256.022ccb19.js"><link rel="prefetch" href="/assets/js/257.fba96473.js"><link rel="prefetch" href="/assets/js/258.b627d685.js"><link rel="prefetch" href="/assets/js/259.28e21856.js"><link rel="prefetch" href="/assets/js/26.5c268ee4.js"><link rel="prefetch" href="/assets/js/260.f320a58f.js"><link rel="prefetch" href="/assets/js/261.442bf05d.js"><link rel="prefetch" href="/assets/js/262.a012b4d6.js"><link rel="prefetch" href="/assets/js/263.232b0668.js"><link rel="prefetch" href="/assets/js/264.9f3b9ebe.js"><link rel="prefetch" href="/assets/js/265.1c544d63.js"><link rel="prefetch" href="/assets/js/266.6a90ae42.js"><link rel="prefetch" href="/assets/js/267.5d57043b.js"><link rel="prefetch" href="/assets/js/268.a0efd2ca.js"><link rel="prefetch" href="/assets/js/269.fb357b46.js"><link rel="prefetch" href="/assets/js/27.c523847e.js"><link rel="prefetch" href="/assets/js/270.f78d8594.js"><link rel="prefetch" href="/assets/js/271.9d7ac7ee.js"><link rel="prefetch" href="/assets/js/272.4c66855d.js"><link rel="prefetch" href="/assets/js/273.48679754.js"><link rel="prefetch" href="/assets/js/274.2ba1afeb.js"><link rel="prefetch" href="/assets/js/275.ddc36b82.js"><link rel="prefetch" href="/assets/js/276.da9d42ba.js"><link rel="prefetch" href="/assets/js/277.8de6668b.js"><link rel="prefetch" href="/assets/js/278.4f40272a.js"><link rel="prefetch" href="/assets/js/279.1e7e051f.js"><link rel="prefetch" href="/assets/js/28.fd9ad585.js"><link rel="prefetch" href="/assets/js/280.7963e7a1.js"><link rel="prefetch" href="/assets/js/281.aa162023.js"><link rel="prefetch" href="/assets/js/282.7c154873.js"><link rel="prefetch" href="/assets/js/283.fce06b4b.js"><link rel="prefetch" href="/assets/js/284.85ba0950.js"><link rel="prefetch" href="/assets/js/285.cb1d1847.js"><link rel="prefetch" href="/assets/js/286.d22e9a94.js"><link rel="prefetch" href="/assets/js/287.1c447fe2.js"><link rel="prefetch" href="/assets/js/29.ae01a76e.js"><link rel="prefetch" href="/assets/js/30.5d12445f.js"><link rel="prefetch" href="/assets/js/31.40d895e0.js"><link rel="prefetch" href="/assets/js/32.d804069c.js"><link rel="prefetch" href="/assets/js/33.986d8626.js"><link rel="prefetch" href="/assets/js/34.6d4f343d.js"><link rel="prefetch" href="/assets/js/35.f3fe9c5b.js"><link rel="prefetch" href="/assets/js/36.e595add3.js"><link rel="prefetch" href="/assets/js/37.0af0dd97.js"><link rel="prefetch" href="/assets/js/38.0d46b6a1.js"><link rel="prefetch" href="/assets/js/39.54cd0bc6.js"><link rel="prefetch" href="/assets/js/4.632d617f.js"><link rel="prefetch" href="/assets/js/40.14f3866f.js"><link rel="prefetch" href="/assets/js/41.9b73489b.js"><link rel="prefetch" href="/assets/js/42.b2dbd5e2.js"><link rel="prefetch" href="/assets/js/43.a2228318.js"><link rel="prefetch" href="/assets/js/44.9b669393.js"><link rel="prefetch" href="/assets/js/45.61f31cb8.js"><link rel="prefetch" href="/assets/js/46.acf45d98.js"><link rel="prefetch" href="/assets/js/47.9fe02aa4.js"><link rel="prefetch" href="/assets/js/48.fb146ee2.js"><link rel="prefetch" href="/assets/js/49.04fad2e1.js"><link rel="prefetch" href="/assets/js/5.cfee286e.js"><link rel="prefetch" href="/assets/js/50.9b60306c.js"><link rel="prefetch" href="/assets/js/51.26406d50.js"><link rel="prefetch" href="/assets/js/52.072a62da.js"><link rel="prefetch" href="/assets/js/53.a47fdb0e.js"><link rel="prefetch" href="/assets/js/54.cc809413.js"><link rel="prefetch" href="/assets/js/55.ba79f41b.js"><link rel="prefetch" href="/assets/js/56.e18205ec.js"><link rel="prefetch" href="/assets/js/57.6387c8cf.js"><link rel="prefetch" href="/assets/js/58.6126efe9.js"><link rel="prefetch" href="/assets/js/59.3ee14771.js"><link rel="prefetch" href="/assets/js/6.32d5e3c9.js"><link rel="prefetch" href="/assets/js/60.e131c84c.js"><link rel="prefetch" href="/assets/js/61.ac70d0fd.js"><link rel="prefetch" href="/assets/js/62.4d78c883.js"><link rel="prefetch" href="/assets/js/63.f1673ed5.js"><link rel="prefetch" href="/assets/js/64.75c1d960.js"><link rel="prefetch" href="/assets/js/65.17f6f270.js"><link rel="prefetch" href="/assets/js/66.c41c79ac.js"><link rel="prefetch" href="/assets/js/67.d436b4bf.js"><link rel="prefetch" href="/assets/js/68.934a6989.js"><link rel="prefetch" href="/assets/js/69.8d7e0582.js"><link rel="prefetch" href="/assets/js/7.09a0a58f.js"><link rel="prefetch" href="/assets/js/70.5478ce89.js"><link rel="prefetch" href="/assets/js/71.47452bed.js"><link rel="prefetch" href="/assets/js/72.d8021923.js"><link rel="prefetch" href="/assets/js/73.ce988899.js"><link rel="prefetch" href="/assets/js/74.eda7e6a9.js"><link rel="prefetch" href="/assets/js/75.c4b54daa.js"><link rel="prefetch" href="/assets/js/76.def7577f.js"><link rel="prefetch" href="/assets/js/77.136b5ce4.js"><link rel="prefetch" href="/assets/js/78.16b0aac6.js"><link rel="prefetch" href="/assets/js/79.d7f87844.js"><link rel="prefetch" href="/assets/js/8.06b4cfd0.js"><link rel="prefetch" href="/assets/js/80.29285523.js"><link rel="prefetch" href="/assets/js/81.ce3f2478.js"><link rel="prefetch" href="/assets/js/82.9d42d270.js"><link rel="prefetch" href="/assets/js/83.c86347a5.js"><link rel="prefetch" href="/assets/js/84.b080e73d.js"><link rel="prefetch" href="/assets/js/85.7d901be3.js"><link rel="prefetch" href="/assets/js/86.574fa4c1.js"><link rel="prefetch" href="/assets/js/87.528e9a78.js"><link rel="prefetch" href="/assets/js/88.87ca45c1.js"><link rel="prefetch" href="/assets/js/89.2e9244aa.js"><link rel="prefetch" href="/assets/js/9.58340067.js"><link rel="prefetch" href="/assets/js/90.a8c05f0c.js"><link rel="prefetch" href="/assets/js/91.ad908c88.js"><link rel="prefetch" href="/assets/js/92.9e2883c0.js"><link rel="prefetch" href="/assets/js/93.07896987.js"><link rel="prefetch" href="/assets/js/94.695b0264.js"><link rel="prefetch" href="/assets/js/95.e35bd0f6.js"><link rel="prefetch" href="/assets/js/96.907c0900.js"><link rel="prefetch" href="/assets/js/97.7a7716d5.js"><link rel="prefetch" href="/assets/js/98.89c3fc09.js"><link rel="prefetch" href="/assets/js/99.b4ae9390.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.27982d69.js">
    <link rel="stylesheet" href="/assets/css/0.styles.53b4846f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><img src="/img/logo.png" alt=" " class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/UserGuide/Master/Get Started/QuickStart.html" class="nav-link">In progress</a></li><li class="dropdown-item"><!----> <a href="/zh/UserGuide/V0.10.x/Get Started/QuickStart.html" class="nav-link">V0.10.x</a></li><li class="dropdown-item"><!----> <a href="/zh/UserGuide/V0.9.x/0-Get Started/1-QuickStart.html" class="nav-link">V0.9.x</a></li><li class="dropdown-item"><!----> <a href="/zh/UserGuide/V0.8.x/0-Get Started/1-QuickStart.html" class="nav-link">V0.8.x</a></li></ul></div></div><div class="nav-item"><a href="/zh/SystemDesign/Architecture/Architecture.html" class="nav-link">系统设计</a></div><div class="nav-item"><a href="/zh/Download/" class="nav-link">下载</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">社区</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://cwiki.apache.org/confluence/display/iotdb" class="nav-link external">
  Wiki
  <!----></a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Community-Project Committers.html" class="nav-link">开发人员</a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Community-Powered By.html" class="nav-link">技术支持</a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Materials.html" class="nav-link">活动与报告</a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Feedback.html" class="nav-link">交流与反馈</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/Development/VoteRelease.html" class="nav-link">如何投票</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/HowToCommit.html" class="nav-link">如何提交代码</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/Committer.html" class="nav-link">成为Committer</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/ContributeGuide.html" class="nav-link">项目开发指南</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/format-changelist.html" class="nav-link">TsFile的更改列表</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/rpc-changelist.html" class="nav-link">RPC变更清单</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ASF</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.apache.org/" class="nav-link external">
  基金会
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/licenses/" class="nav-link external">
  许可证
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/security/" class="nav-link external">
  安全
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/sponsorship.html" class="nav-link external">
  赞助
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/thanks.html" class="nav-link external">
  致谢
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/events/current-event" class="nav-link external">
  活动
  <!----></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/SystemDesign/StorageEngine/TsFileManagement.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/apache/iotdb.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    gitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/UserGuide/Master/Get Started/QuickStart.html" class="nav-link">In progress</a></li><li class="dropdown-item"><!----> <a href="/zh/UserGuide/V0.10.x/Get Started/QuickStart.html" class="nav-link">V0.10.x</a></li><li class="dropdown-item"><!----> <a href="/zh/UserGuide/V0.9.x/0-Get Started/1-QuickStart.html" class="nav-link">V0.9.x</a></li><li class="dropdown-item"><!----> <a href="/zh/UserGuide/V0.8.x/0-Get Started/1-QuickStart.html" class="nav-link">V0.8.x</a></li></ul></div></div><div class="nav-item"><a href="/zh/SystemDesign/Architecture/Architecture.html" class="nav-link">系统设计</a></div><div class="nav-item"><a href="/zh/Download/" class="nav-link">下载</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">社区</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://cwiki.apache.org/confluence/display/iotdb" class="nav-link external">
  Wiki
  <!----></a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Community-Project Committers.html" class="nav-link">开发人员</a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Community-Powered By.html" class="nav-link">技术支持</a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Materials.html" class="nav-link">活动与报告</a></li><li class="dropdown-item"><!----> <a href="/zh/Community/Feedback.html" class="nav-link">交流与反馈</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zh/Development/VoteRelease.html" class="nav-link">如何投票</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/HowToCommit.html" class="nav-link">如何提交代码</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/Committer.html" class="nav-link">成为Committer</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/ContributeGuide.html" class="nav-link">项目开发指南</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/format-changelist.html" class="nav-link">TsFile的更改列表</a></li><li class="dropdown-item"><!----> <a href="/zh/Development/rpc-changelist.html" class="nav-link">RPC变更清单</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ASF</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.apache.org/" class="nav-link external">
  基金会
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/licenses/" class="nav-link external">
  许可证
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/security/" class="nav-link external">
  安全
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/sponsorship.html" class="nav-link external">
  赞助
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/foundation/thanks.html" class="nav-link external">
  致谢
  <!----></a></li><li class="dropdown-item"><!----> <a href="http://www.apache.org/events/current-event" class="nav-link external">
  活动
  <!----></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/SystemDesign/StorageEngine/TsFileManagement.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/apache/iotdb.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    gitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>系统设计</span> <!----></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>应用概览</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TsFile</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>查询引擎</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>元数据管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>存储引擎</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据查询</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>连接器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>客户端</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content content__default"><h1 id="tsfilemanagement-热合并"><a href="#tsfilemanagement-热合并" class="header-anchor">#</a> TsFileManagement -热合并</h1> <h2 id="整体思路"><a href="#整体思路" class="header-anchor">#</a> 整体思路</h2> <p>现在 iotdb 会因为自动参数优化将很小的数据块写入文件，使得数据文件变得零散化，这导致了用户进行即席查询时需要的读盘次数过多，而后期的合并过程又不是即时进行的，这导致了系统对热数据的查询效率变慢，所以我们借鉴了虚拟内存的思想，在写入流程中增加了热合并过程，通过提高一部分写放大保证了写入到正式文件的数据块不小于给定阈值，提升系统即席查询的效率。将这部分逻辑写到 StorageGroupProcessor 里去，针对封口的 tsfile 文件进行合并。</p> <ul><li>配置修改
<ul><li>iotdb-engine.properties 加一个参数 tsfile_manage_strategy：表示 tsfile 文件管理策略</li> <li>tsfile_manage_strategy 内置两个策略：LevelStsrategy 和 NormalStrategy</li> <li>LevelStrategy 即开启热合并并使用层级合并方法，NormalStrategy 即关闭热合并</li> <li>iotdb-engine.properties 中加 merge_chunk_point_number：最大的chunk大小限制，LevelStrategy 时，当达到该参数就合并到最后一层</li> <li>iotdb-engine.properties 加一个参数 max_level_num：LevelStrategy 时最大层数</li></ul></li> <li>代码结构修改
<ul><li>新建一个 TsFileManagement 类，专门管理 StorageGroupProcessor 中的 seqFileList 和 unSeqFileList ，在这里写热合并的主体逻辑，对外抽象对seqFileList和unSeqFileList的一系列所需接口</li> <li>对于普通 merge 会调用 TsFileManagement 的 getStableTsFileList() 来获取准备进行文件合并的文件列表，这里对于 LevelStrategy 来说就是返回第 {max_level_num - 1} 层的文件，对于 NormalStrategy 来说就是返回所有文件列表</li> <li>每一次热合并会取第一个被合并文件的时间戳作为新文件的时间戳，即 {firstFileTimestamp}-{version}-{mergeVerion + 1}.tsfiles</li></ul></li></ul> <h2 id="tsfilemanagement-对外提供的接口和类"><a href="#tsfilemanagement-对外提供的接口和类" class="header-anchor">#</a> TsFileManagement 对外提供的接口和类</h2> <ul><li>TsFileManagement 也管理未封口文件</li> <li>TsFileManagement 同时管理 Seq 和 UnSeq 文件列表，在 StorageGroupProcessor 中只创建一个 TsFileManagement</li> <li>List&lt;TsFileResource&gt; getStableTsFileList() 对外提供稳定的 TsFileResource 列表</li> <li>List&lt;TsFileResource&gt; getTsFileList(boolean sequence) 对外提供（顺序/乱序）文件列表（如果 sequence = true，则提供按时间戳顺序的列表）</li> <li>Iterator&lt;TsFileResource&gt; getIterator(boolean sequence) 对外提供（顺序/乱序）文件迭代器（如果 sequence = true，则提供按时间戳顺序的迭代器）</li> <li>void remove(TsFileResource tsFileResource, boolean sequence) 删除对应的 TsFileResource 文件</li> <li>void removeAll(List&lt;TsFileResource&gt; tsfileReourceList, boolean sequence) 删除对应的 TsFileResource 列表</li> <li>void addAll(List&lt;TsFileResource&gt; tsfileReourceList, boolean sequence) 批量加入 TsFileResource 列表</li> <li>boolean isEmpty(boolean sequence) 是否为空</li> <li>int size(boolean sequence) 对应的文件列表长度</li> <li>void forkCurrentFileList(long timePartition) 保存当前文件的某时间分区列表</li> <li>void recover() 调用对应的恢复流程</li> <li>HotCompactionMergeTask 调用对应的异步合并流程，传入 closeUnsealedTsFileProcessorCallBack 以通知外部类合并结束</li></ul> <h2 id="levelstrategy-merge-流程"><a href="#levelstrategy-merge-流程" class="header-anchor">#</a> LevelStrategy merge 流程</h2> <ul><li>外部调用 forkCurrentFileList(long timePartition) 保存当前文件的某时间分区列表
<ul><li>这里选择的文件列表 chunk 点数之和不超出 merge_chunk_point_number</li></ul></li> <li>外部异步创建并提交 merge 线程</li> <li>判断是否要进行全局热合并
<ul><li>生成目标文件 {first_file_name}-{max_level_num - 1}.tsfile</li> <li>生成合并日志 .hot_compaction.log</li> <li>记录是全局合并</li> <li>记录目标文件</li> <li>进行合并（记录日志 device - offset）</li> <li>记录完成合并</li></ul></li> <li>循环判断每一层的文件是否要合并到下一层
<ul><li>生成目标文件 {first_file_name}-{level + 1}.tsfile</li> <li>生成合并日志 .hot_compaction.log</li> <li>记录是层级合并</li> <li>记录目标文件</li> <li>进行合并（记录日志 device - offset）</li> <li>记录完成合并</li></ul></li> <li>加写锁</li> <li>从磁盘删掉待合并的文件，并从正式文件列表中移除</li> <li>删除合并日志 .hot_compaction.log</li> <li>释放写锁</li></ul> <h2 id="levelstrategy-recover-流程"><a href="#levelstrategy-recover-流程" class="header-anchor">#</a> LevelStrategy recover 流程</h2> <ul><li>如果日志文件存在
<ul><li>如果是全局合并（把所有小文件合并到最后一层）
<ul><li>如果合并没结束
<ul><li>截断文件</li> <li>继续全局合并</li></ul></li></ul></li> <li>如果是层级合并
<ul><li>如果合并没结束
<ul><li>截断文件</li> <li>继续层级合并</li></ul></li></ul></li></ul></li> <li>如果日志文件不存在
<ul><li>无需恢复</li></ul></li></ul> <h2 id="levelstrategy-例子"><a href="#levelstrategy-例子" class="header-anchor">#</a> LevelStrategy 例子</h2> <p>设置 max_file_num_in_each_level = 3，tsfile_manage_strategy = LevelStrategy， max_level_num = 3，此时文件结构为，第0层、第1层、第2层，其中第2层是不再做热合并的稳定的文件列表</p> <h3 id="完全根据-level-合并的情况"><a href="#完全根据-level-合并的情况" class="header-anchor">#</a> 完全根据 level 合并的情况</h3> <p>假设此时整个系统中有5个文件，最后一个文件没有关闭,则其结构及顺序分布如下
level-0: t2-0 t3-0 t4-0
level-1: t0-1 t1-1
当最后一个文件关闭，按如下方式合并（第0层的t2-0、t3-0、t4-0文件合并到了第1层的t2-1文件）
level-0: t2-0 t3-0 t4-0
\    \    |
\   \   |
\  \  |
\ \ |
level-1: t0-1 t1-1 t2-1
合并后发现第1层合并后也满了，则继续合并到第2层，最后整个系统只剩下了第2层的t0-2文件
level-0: t2-0 t3-0 t4-0
\    \    |
\   \   |
\  \  |
\ \ |
level-1: t0-1 t1-1 t2-1
|    /     /
|   /    /
|  /   /
| /  /
level-2: t0-2</p> <h3 id="中途满足-merge-chunk-point-number-的情况"><a href="#中途满足-merge-chunk-point-number-的情况" class="header-anchor">#</a> 中途满足 merge_chunk_point_number 的情况</h3> <p>假设此时整个系统中有4个文件，最后一个文件没有关闭,则其结构及顺序分布如下
level-0: t2-0 t3-0
level-1: t0-1 t1-1
当最后一个文件关闭，但是t0-1、t1-1、t2-0、t3-0文件的 chunk point 数量加起来已经满足 merge_chunk_point_number，则做如下合并，即直接将所有文件合并到第2层（稳定层）
level-0: t2-0 t3-0
|    |
level-1: t0-1 t1-1
|    /
|   /
|  /
level-2: t0-2</p> <h3 id="动态参数调整的例子"><a href="#动态参数调整的例子" class="header-anchor">#</a> 动态参数调整的例子</h3> <ul><li>系统会严格按照上文中提到的 merge 流程对多层文件进行选择和合并，这里只介绍到参数调整时，系统初始化过程中文件会被放在哪一层</li> <li>假设max_file_num_in_each_level = 3</li></ul> <ul><li><p>从0.10.0升级</p> <ul><li>将所有文件的 mergeVersion 置为 {max_level_num - 1}</li> <li>即老版本的文件不会被重复合并
假设整个系统中有5个文件，此时恢复后的文件结构为：
level-2: t0-2 t1-2 t2-2 t3-2 t4-2</li></ul></li> <li><p>提高 max_level_num</p> <ul><li>此时因为不会改变任何文件的原 level，所以 recover 时文件还会被放到原来的层上，或超出 {max_level_num - 1} 的文件被放在最后一层（考虑到多次调整的情况）</li> <li>即原文件将基于原来的 level 继续合并，超出 {max_level_num - 1} 部分也不会有乱序问题，因为在最后一层的必然是老文件
假设整个系统中有5个文件，原max_file_num_in_each_level = 2，提高后的max_file_num_in_each_level = 3，此时恢复后的文件结构为：
level-0: t2-0 t3-0 t4-0
level-1: t0-1 t1-1
假设 {size(t2-0)+size(t3-0)+size(t4-0)&lt; merge_chunk_point_number}，则进行合并的过程如下
level-0: t2-0 t3-0 t4-0
\    \    |
\   \   |
\  \  |
\ \ |
level-1: t0-1 t1-1 t2-1
合并后发现第1层合并后也满了，则继续合并到第2层，最后整个系统只剩下了第2层的t0-2文件
level-0: t2-0 t3-0 t4-0
\    \    |
\   \   |
\  \  |
\ \ |
level-1: t0-1 t1-1 t2-1
|    /     /
|   /    /
|  /   /
| /  /
level-2: t0-2</li></ul></li> <li><p>降低 max_level_num</p> <ul><li>此时因为不会改变任何文件的原 level，所以 recover 时小于此时 {max_level_num - 1} 的文件还会被放到原来的层上，而超出的文件将被放在最后一层</li> <li>即部分文件将被继续合并，而超出 {max_level_num - 2} 的文件将不会再被热合并
假设整个系统中有7个文件，原max_file_num_in_each_level = 3，降低后的max_file_num_in_each_level = 2，此时恢复后的文件结构为：
level-0: t4-0 t5-0 t6-0
level-1: t0-2 t1-1 t2-1 t3-1
假设 {size(t2-0)+size(t3-0)+size(t4-0)&lt; merge_chunk_point_number}，则进行合并的过程如下
level-0:          t2-0 t3-0 t4-0
\    \    |
\   \   |
\  \  |
\ \ |
level-1: t0-2 t1-1 t2-1 t3-1 t4-1
合并后发现第1层合并后也满了，则继续合并到第2层
level-0:          t2-0 t3-0 t4-0
\    \    |
\   \   |
\  \  |
\ \ |
level-1: t0-2 t1-1 t2-1 t3-1 t4-1
|    /     /
|   /    /
|  /   /
| /  /
level-2: t0-2
最后剩下的文件结构为
level-0:
level-1: t3-1 t4-1
level-2: t0-2</li></ul></li> <li><p>NormalStrategy -&gt; LevelStrategy</p> <ul><li>此时因为因为删去了原始合并的 {mergeVersion + 1} 策略，所以所有文件将全部被放到0层</li> <li>每一次热合并会最多取出满足 {merge_chunk_point_number} 的文件进行合并，直到将所有多余的文件热合并完，进入正常的热合并流程
假设整个系统中有5个文件，此时恢复后的文件结构为：
level-2: t0-0 t1-0 t2-0 t3-0 t4-0
假设 {size(t0-0)+size(t1-0)&gt;=merge_chunk_point_number}，则进行第一次合并的过程如下
level-0: t0-0 t1-0 t2-0 t3-0 t4-0 t5-0(新增了文件才会触发合并检查)
|   /
|  /
| /
level-2: t0-2
假设 {size(t2-0)+size(t3-0)&gt;=merge_chunk_point_number}，则进行第二次合并的过程如下
level-0: t2-0 t3-0 t4-0 t5-0 t6-0(新增了文件才会触发合并检查)
\    |
\   |
\  |
level-2: t0-2 t2-2
假设 {size(t4-0)+size(t5-0)+size(t6-0)+size(t7-0)&lt; merge_chunk_point_number}，则进行第三次合并的过程如下
level-0: t4-0 t5-0 t6-0 t7-0(新增了文件才会触发合并检查)
|    /   /
|   /  /
|  / /
| //<br>
level-1: t4-1</li></ul></li></ul> <p>level-2: t0-2 t2-2</p></div> <!----> <p style="text-align: center;">Copyright © 2020 The Apache Software Foundation.<br>
     Apache and the Apache feather logo are trademarks of The Apache Software Foundation</p></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7e8d0fee.js" defer></script><script src="/assets/js/3.187083c5.js" defer></script><script src="/assets/js/190.02ee3914.js" defer></script>
  </body>
</html>